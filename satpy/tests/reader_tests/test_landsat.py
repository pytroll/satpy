#!/usr/bin/python
# Copyright (c) 2018 Satpy developers
#
# This file is part of satpy.
#
# satpy is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# satpy is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
# A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# satpy.  If not, see <http://www.gnu.org/licenses/>.
"""Unittests for Landsat image readers."""

import os
from datetime import datetime, timezone

import dask.array as da
import numpy as np
import pytest
import xarray as xr
from pyresample.geometry import AreaDefinition

from satpy import Scene
from satpy.readers.core.landsat import (
    ETMCHReader,
    ETML2CHReader,
    LandsatL1MDReader,
    LandsatL2MDReader,
    MSSCHReader,
    OLITIRSCHReader,
    OLITIRSL2CHReader,
    TMCHReader,
    TML2CHReader,
)

oli_tirs_l1_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P975CC9B</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LC08_L1TP_026200_20240502_20240513_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LC08_L1TP_026200_20240502_20240513_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC08_L1TP_026200_20240502_20240513_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC08_L1TP_026200_20240502_20240513_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC08_L1TP_026200_20240502_20240513_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC08_L1TP_026200_20240502_20240513_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC08_L1TP_026200_20240502_20240513_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LC08_L1TP_026200_20240502_20240513_02_T2_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_BAND_9>LC08_L1TP_026200_20240502_20240513_02_T2_B9.TIF</FILE_NAME_BAND_9>
    <FILE_NAME_BAND_10>LC08_L1TP_026200_20240502_20240513_02_T2_B10.TIF</FILE_NAME_BAND_10>
    <FILE_NAME_BAND_11>LC08_L1TP_026200_20240502_20240513_02_T2_B11.TIF</FILE_NAME_BAND_11>
    <FILE_NAME_QUALITY_L1_PIXEL>LC08_L1TP_026200_20240502_20240513_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC08_L1TP_026200_20240502_20240513_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC08_L1TP_026200_20240502_20240513_02_T2_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LC08_L1TP_026200_20240502_20240513_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC08_L1TP_026200_20240502_20240513_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT16</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT16</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT16</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT16</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT16</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6>UINT16</DATA_TYPE_BAND_6>
    <DATA_TYPE_BAND_7>UINT16</DATA_TYPE_BAND_7>
    <DATA_TYPE_BAND_8>UINT16</DATA_TYPE_BAND_8>
    <DATA_TYPE_BAND_9>UINT16</DATA_TYPE_BAND_9>
    <DATA_TYPE_BAND_10>UINT16</DATA_TYPE_BAND_10>
    <DATA_TYPE_BAND_11>UINT16</DATA_TYPE_BAND_11>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_8</SPACECRAFT_ID>
    <SENSOR_ID>OLI_TIRS</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>26</WRS_PATH>
    <WRS_ROW>200</WRS_ROW>
    <NADIR_OFFNADIR>NADIR</NADIR_OFFNADIR>
    <TARGET_WRS_PATH>26</TARGET_WRS_PATH>
    <TARGET_WRS_ROW>200</TARGET_WRS_ROW>
    <DATE_ACQUIRED>2024-05-02</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>18:00:24.6148649Z</SCENE_CENTER_TIME>
    <STATION_ID>LGN</STATION_ID>
    <CLOUD_COVER>0.85</CLOUD_COVER>
    <CLOUD_COVER_LAND>-1</CLOUD_COVER_LAND>
    <IMAGE_QUALITY_OLI>9</IMAGE_QUALITY_OLI>
    <IMAGE_QUALITY_TIRS>9</IMAGE_QUALITY_TIRS>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>N</SATURATION_BAND_2>
    <SATURATION_BAND_3>N</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>N</SATURATION_BAND_6>
    <SATURATION_BAND_7>N</SATURATION_BAND_7>
    <SATURATION_BAND_8>N</SATURATION_BAND_8>
    <SATURATION_BAND_9>N</SATURATION_BAND_9>
    <ROLL_ANGLE>-0.000</ROLL_ANGLE>
    <SUN_AZIMUTH>-39.71362413</SUN_AZIMUTH>
    <SUN_ELEVATION>-41.46228969</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0079981</EARTH_SUN_DISTANCE>
    <TRUNCATION_OLI>UPPER</TRUNCATION_OLI>
    <TIRS_SSM_MODEL>FINAL</TIRS_SSM_MODEL>
    <TIRS_SSM_POSITION_STATUS>ESTIMATED</TIRS_SSM_POSITION_STATUS>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>40</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <PANCHROMATIC_LINES>200</PANCHROMATIC_LINES>
    <PANCHROMATIC_SAMPLES>200</PANCHROMATIC_SAMPLES>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>24.18941</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>58.17657</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>24.15493</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>60.44878</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>22.06522</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>58.15819</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>22.03410</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>60.39501</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>619500.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>2675700.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>850500.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>2675700.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>619500.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>2440500.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>850500.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>2440500.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P975CC9B</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1885324_00001</REQUEST_ID>
    <LANDSAT_SCENE_ID>LC80262002024123LGN00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LC08_L1TP_026200_20240502_20240513_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2024-05-13T15:32:54Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.4.0</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LC08_L1TP_026200_20240502_20240513_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC08_L1TP_026200_20240502_20240513_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC08_L1TP_026200_20240502_20240513_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC08_L1TP_026200_20240502_20240513_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC08_L1TP_026200_20240502_20240513_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC08_L1TP_026200_20240502_20240513_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LC08_L1TP_026200_20240502_20240513_02_T2_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_BAND_9>LC08_L1TP_026200_20240502_20240513_02_T2_B9.TIF</FILE_NAME_BAND_9>
    <FILE_NAME_BAND_10>LC08_L1TP_026200_20240502_20240513_02_T2_B10.TIF</FILE_NAME_BAND_10>
    <FILE_NAME_BAND_11>LC08_L1TP_026200_20240502_20240513_02_T2_B11.TIF</FILE_NAME_BAND_11>
    <FILE_NAME_QUALITY_L1_PIXEL>LC08_L1TP_026200_20240502_20240513_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC08_L1TP_026200_20240502_20240513_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC08_L1TP_026200_20240502_20240513_02_T2_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LC08_L1TP_026200_20240502_20240513_02_T2_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LC08_L1TP_026200_20240502_20240513_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC08_L1TP_026200_20240502_20240513_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LC08CPF_20240429_20240630_02.03</FILE_NAME_CPF>
    <FILE_NAME_BPF_OLI>LO8BPF20240502162846_20240502181430.01</FILE_NAME_BPF_OLI>
    <FILE_NAME_BPF_TIRS>LT8BPF20240502144307_20240510102926.01</FILE_NAME_BPF_TIRS>
    <FILE_NAME_RLUT>LC08RLUT_20150303_20431231_02_01.h5</FILE_NAME_RLUT>
    <DATA_SOURCE_TIRS_STRAY_LIGHT_CORRECTION>TIRS</DATA_SOURCE_TIRS_STRAY_LIGHT_CORRECTION>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>748.04883</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-61.77412</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>766.01111</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-63.25745</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>705.87274</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-58.29120</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>595.23163</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-49.15442</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>364.25208</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-30.08006</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>90.58618</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>-7.48064</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>30.53239</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-2.52137</RADIANCE_MINIMUM_BAND_7>
    <RADIANCE_MAXIMUM_BAND_8>673.63843</RADIANCE_MAXIMUM_BAND_8>
    <RADIANCE_MINIMUM_BAND_8>-55.62928</RADIANCE_MINIMUM_BAND_8>
    <RADIANCE_MAXIMUM_BAND_9>142.35797</RADIANCE_MAXIMUM_BAND_9>
    <RADIANCE_MINIMUM_BAND_9>-11.75597</RADIANCE_MINIMUM_BAND_9>
    <RADIANCE_MAXIMUM_BAND_10>22.00180</RADIANCE_MAXIMUM_BAND_10>
    <RADIANCE_MINIMUM_BAND_10>0.10033</RADIANCE_MINIMUM_BAND_10>
    <RADIANCE_MAXIMUM_BAND_11>22.00180</RADIANCE_MAXIMUM_BAND_11>
    <RADIANCE_MINIMUM_BAND_11>0.10033</RADIANCE_MINIMUM_BAND_11>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>1.210700</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.099980</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.210700</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.099980</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.210700</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.099980</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.210700</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.099980</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.210700</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.099980</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_6>1.210700</REFLECTANCE_MAXIMUM_BAND_6>
    <REFLECTANCE_MINIMUM_BAND_6>-0.099980</REFLECTANCE_MINIMUM_BAND_6>
    <REFLECTANCE_MAXIMUM_BAND_7>1.210700</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.099980</REFLECTANCE_MINIMUM_BAND_7>
    <REFLECTANCE_MAXIMUM_BAND_8>1.210700</REFLECTANCE_MAXIMUM_BAND_8>
    <REFLECTANCE_MINIMUM_BAND_8>-0.099980</REFLECTANCE_MINIMUM_BAND_8>
    <REFLECTANCE_MAXIMUM_BAND_9>1.210700</REFLECTANCE_MAXIMUM_BAND_9>
    <REFLECTANCE_MINIMUM_BAND_9>-0.099980</REFLECTANCE_MINIMUM_BAND_9>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>65535</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_8>65535</QUANTIZE_CAL_MAX_BAND_8>
    <QUANTIZE_CAL_MIN_BAND_8>1</QUANTIZE_CAL_MIN_BAND_8>
    <QUANTIZE_CAL_MAX_BAND_9>65535</QUANTIZE_CAL_MAX_BAND_9>
    <QUANTIZE_CAL_MIN_BAND_9>1</QUANTIZE_CAL_MIN_BAND_9>
    <QUANTIZE_CAL_MAX_BAND_10>65535</QUANTIZE_CAL_MAX_BAND_10>
    <QUANTIZE_CAL_MIN_BAND_10>1</QUANTIZE_CAL_MIN_BAND_10>
    <QUANTIZE_CAL_MAX_BAND_11>65535</QUANTIZE_CAL_MAX_BAND_11>
    <QUANTIZE_CAL_MIN_BAND_11>1</QUANTIZE_CAL_MIN_BAND_11>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>1.2357E-02</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>1.2654E-02</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>1.1661E-02</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>9.8329E-03</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>6.0172E-03</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>1.4964E-03</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>5.0438E-04</RADIANCE_MULT_BAND_7>
    <RADIANCE_MULT_BAND_8>1.1128E-02</RADIANCE_MULT_BAND_8>
    <RADIANCE_MULT_BAND_9>2.3517E-03</RADIANCE_MULT_BAND_9>
    <RADIANCE_MULT_BAND_10>3.3420E-04</RADIANCE_MULT_BAND_10>
    <RADIANCE_MULT_BAND_11>3.3420E-04</RADIANCE_MULT_BAND_11>
    <RADIANCE_ADD_BAND_1>-61.78647</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-63.27010</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-58.30286</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-49.16426</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-30.08607</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>-7.48213</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-2.52188</RADIANCE_ADD_BAND_7>
    <RADIANCE_ADD_BAND_8>-55.64041</RADIANCE_ADD_BAND_8>
    <RADIANCE_ADD_BAND_9>-11.75832</RADIANCE_ADD_BAND_9>
    <RADIANCE_ADD_BAND_10>0.10000</RADIANCE_ADD_BAND_10>
    <RADIANCE_ADD_BAND_11>0.10000</RADIANCE_ADD_BAND_11>
    <REFLECTANCE_MULT_BAND_1>2.0000E-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.0000E-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.0000E-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.0000E-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.0000E-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_6>2.0000E-05</REFLECTANCE_MULT_BAND_6>
    <REFLECTANCE_MULT_BAND_7>2.0000E-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_MULT_BAND_8>2.0000E-05</REFLECTANCE_MULT_BAND_8>
    <REFLECTANCE_MULT_BAND_9>2.0000E-05</REFLECTANCE_MULT_BAND_9>
    <REFLECTANCE_ADD_BAND_1>-0.100000</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.100000</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.100000</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.100000</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.100000</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_6>-0.100000</REFLECTANCE_ADD_BAND_6>
    <REFLECTANCE_ADD_BAND_7>-0.100000</REFLECTANCE_ADD_BAND_7>
    <REFLECTANCE_ADD_BAND_8>-0.100000</REFLECTANCE_ADD_BAND_8>
    <REFLECTANCE_ADD_BAND_9>-0.100000</REFLECTANCE_ADD_BAND_9>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_10>774.8853</K1_CONSTANT_BAND_10>
    <K2_CONSTANT_BAND_10>1321.0789</K2_CONSTANT_BAND_10>
    <K1_CONSTANT_BAND_11>480.8883</K1_CONSTANT_BAND_11>
    <K2_CONSTANT_BAND_11>1201.1442</K2_CONSTANT_BAND_11>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>40</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
  </LEVEL1_PROJECTION_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


oli_tirs_l2_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9OGBGM6</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LC09_L2SP_029030_20240616_20240617_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC09_L2SP_029030_20240616_20240617_02_T1_SR_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_ST_B10>LC09_L2SP_029030_20240616_20240617_02_T1_ST_B10.TIF</FILE_NAME_BAND_ST_B10>
    <FILE_NAME_THERMAL_RADIANCE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_TRAD.TIF</FILE_NAME_THERMAL_RADIANCE>
    <FILE_NAME_UPWELL_RADIANCE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_URAD.TIF</FILE_NAME_UPWELL_RADIANCE>
    <FILE_NAME_DOWNWELL_RADIANCE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_DRAD.TIF</FILE_NAME_DOWNWELL_RADIANCE>
    <FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_ATRAN.TIF</FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>
    <FILE_NAME_EMISSIVITY>LC09_L2SP_029030_20240616_20240617_02_T1_ST_EMIS.TIF</FILE_NAME_EMISSIVITY>
    <FILE_NAME_EMISSIVITY_STDEV>LC09_L2SP_029030_20240616_20240617_02_T1_ST_EMSD.TIF</FILE_NAME_EMISSIVITY_STDEV>
    <FILE_NAME_CLOUD_DISTANCE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_CDIST.TIF</FILE_NAME_CLOUD_DISTANCE>
    <FILE_NAME_QUALITY_L2_AEROSOL>LC09_L2SP_029030_20240616_20240617_02_T1_SR_QA_AEROSOL.TIF</FILE_NAME_QUALITY_L2_AEROSOL>
    <FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>LC09_L2SP_029030_20240616_20240617_02_T1_ST_QA.TIF</FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>
    <FILE_NAME_QUALITY_L1_PIXEL>LC09_L2SP_029030_20240616_20240617_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC09_L2SP_029030_20240616_20240617_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC09_L2SP_029030_20240616_20240617_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_METADATA_ODL>LC09_L2SP_029030_20240616_20240617_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC09_L2SP_029030_20240616_20240617_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT16</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT16</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT16</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT16</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT16</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6>UINT16</DATA_TYPE_BAND_6>
    <DATA_TYPE_BAND_7>UINT16</DATA_TYPE_BAND_7>
    <DATA_TYPE_BAND_ST_B10>UINT16</DATA_TYPE_BAND_ST_B10>
    <DATA_TYPE_THERMAL_RADIANCE>INT16</DATA_TYPE_THERMAL_RADIANCE>
    <DATA_TYPE_UPWELL_RADIANCE>INT16</DATA_TYPE_UPWELL_RADIANCE>
    <DATA_TYPE_DOWNWELL_RADIANCE>INT16</DATA_TYPE_DOWNWELL_RADIANCE>
    <DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>INT16</DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>
    <DATA_TYPE_EMISSIVITY>INT16</DATA_TYPE_EMISSIVITY>
    <DATA_TYPE_EMISSIVITY_STDEV>INT16</DATA_TYPE_EMISSIVITY_STDEV>
    <DATA_TYPE_CLOUD_DISTANCE>INT16</DATA_TYPE_CLOUD_DISTANCE>
    <DATA_TYPE_QUALITY_L2_AEROSOL>UINT8</DATA_TYPE_QUALITY_L2_AEROSOL>
    <DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>INT16</DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_9</SPACECRAFT_ID>
    <SENSOR_ID>OLI_TIRS</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>29</WRS_PATH>
    <WRS_ROW>30</WRS_ROW>
    <NADIR_OFFNADIR>NADIR</NADIR_OFFNADIR>
    <TARGET_WRS_PATH>29</TARGET_WRS_PATH>
    <TARGET_WRS_ROW>30</TARGET_WRS_ROW>
    <DATE_ACQUIRED>2024-06-16</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>17:10:58.5278200Z</SCENE_CENTER_TIME>
    <STATION_ID>LGN</STATION_ID>
    <CLOUD_COVER>29.27</CLOUD_COVER>
    <CLOUD_COVER_LAND>29.27</CLOUD_COVER_LAND>
    <IMAGE_QUALITY_OLI>9</IMAGE_QUALITY_OLI>
    <IMAGE_QUALITY_TIRS>9</IMAGE_QUALITY_TIRS>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>N</SATURATION_BAND_2>
    <SATURATION_BAND_3>N</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>Y</SATURATION_BAND_6>
    <SATURATION_BAND_7>Y</SATURATION_BAND_7>
    <SATURATION_BAND_8>N</SATURATION_BAND_8>
    <SATURATION_BAND_9>N</SATURATION_BAND_9>
    <ROLL_ANGLE>0.000</ROLL_ANGLE>
    <SUN_AZIMUTH>134.43500878</SUN_AZIMUTH>
    <SUN_ELEVATION>64.41443455</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0158933</EARTH_SUN_DISTANCE>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>44.24610</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-98.56289</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>44.19877</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>-95.68366</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>42.14174</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-98.57765</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>42.09775</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>-95.79546</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>534900.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>4899300.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>765000.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>4899300.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>534900.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>4665600.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>765000.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>4665600.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL2_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9OGBGM6</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1898780_00011</REQUEST_ID>
    <LANDSAT_PRODUCT_ID>LC09_L2SP_029030_20240616_20240617_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2024-06-17T11:12:45Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.4.0</PROCESSING_SOFTWARE_VERSION>
    <ALGORITHM_SOURCE_SURFACE_REFLECTANCE>LaSRC_1.6.0</ALGORITHM_SOURCE_SURFACE_REFLECTANCE>
    <DATA_SOURCE_OZONE>VIIRS</DATA_SOURCE_OZONE>
    <DATA_SOURCE_PRESSURE>Calculated</DATA_SOURCE_PRESSURE>
    <DATA_SOURCE_WATER_VAPOR>VIIRS</DATA_SOURCE_WATER_VAPOR>
    <DATA_SOURCE_AIR_TEMPERATURE>VIIRS</DATA_SOURCE_AIR_TEMPERATURE>
    <ALGORITHM_SOURCE_SURFACE_TEMPERATURE>st_1.5.0</ALGORITHM_SOURCE_SURFACE_TEMPERATURE>
    <DATA_SOURCE_REANALYSIS>GEOS-5 IT</DATA_SOURCE_REANALYSIS>
  </LEVEL2_PROCESSING_RECORD>
  <LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
    <REFLECTANCE_MAXIMUM_BAND_1>1.602213</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.199972</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.602213</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.199972</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.602213</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.199972</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.602213</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.199972</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.602213</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.199972</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_6>1.602213</REFLECTANCE_MAXIMUM_BAND_6>
    <REFLECTANCE_MINIMUM_BAND_6>-0.199972</REFLECTANCE_MINIMUM_BAND_6>
    <REFLECTANCE_MAXIMUM_BAND_7>1.602213</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.199972</REFLECTANCE_MINIMUM_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>65535</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <REFLECTANCE_MULT_BAND_1>2.75e-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.75e-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.75e-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.75e-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.75e-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_6>2.75e-05</REFLECTANCE_MULT_BAND_6>
    <REFLECTANCE_MULT_BAND_7>2.75e-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_1>-0.2</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.2</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.2</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.2</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.2</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_6>-0.2</REFLECTANCE_ADD_BAND_6>
    <REFLECTANCE_ADD_BAND_7>-0.2</REFLECTANCE_ADD_BAND_7>
  </LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
  <LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
    <TEMPERATURE_MAXIMUM_BAND_ST_B10>372.999941</TEMPERATURE_MAXIMUM_BAND_ST_B10>
    <TEMPERATURE_MINIMUM_BAND_ST_B10>149.003418</TEMPERATURE_MINIMUM_BAND_ST_B10>
    <QUANTIZE_CAL_MAXIMUM_BAND_ST_B10>65535</QUANTIZE_CAL_MAXIMUM_BAND_ST_B10>
    <QUANTIZE_CAL_MINIMUM_BAND_ST_B10>1</QUANTIZE_CAL_MINIMUM_BAND_ST_B10>
    <TEMPERATURE_MULT_BAND_ST_B10>0.00341802</TEMPERATURE_MULT_BAND_ST_B10>
    <TEMPERATURE_ADD_BAND_ST_B10>149.0</TEMPERATURE_ADD_BAND_ST_B10>
  </LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P975CC9B</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1898675_00011</REQUEST_ID>
    <LANDSAT_SCENE_ID>LC90290302024168LGN00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LC09_L1TP_029030_20240616_20240616_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2024-06-16T22:54:36Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.4.0</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LC09_L1TP_029030_20240616_20240616_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC09_L1TP_029030_20240616_20240616_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC09_L1TP_029030_20240616_20240616_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC09_L1TP_029030_20240616_20240616_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC09_L1TP_029030_20240616_20240616_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC09_L1TP_029030_20240616_20240616_02_T1_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC09_L1TP_029030_20240616_20240616_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LC09_L1TP_029030_20240616_20240616_02_T1_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_BAND_9>LC09_L1TP_029030_20240616_20240616_02_T1_B9.TIF</FILE_NAME_BAND_9>
    <FILE_NAME_BAND_10>LC09_L1TP_029030_20240616_20240616_02_T1_B10.TIF</FILE_NAME_BAND_10>
    <FILE_NAME_BAND_11>LC09_L1TP_029030_20240616_20240616_02_T1_B11.TIF</FILE_NAME_BAND_11>
    <FILE_NAME_QUALITY_L1_PIXEL>LC09_L1TP_029030_20240616_20240616_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC09_L1TP_029030_20240616_20240616_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC09_L1TP_029030_20240616_20240616_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LC09_L1TP_029030_20240616_20240616_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LC09_L1TP_029030_20240616_20240616_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LC09_L1TP_029030_20240616_20240616_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LC09_L1TP_029030_20240616_20240616_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LC09_L1TP_029030_20240616_20240616_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC09_L1TP_029030_20240616_20240616_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LC09CPF_20240401_20240630_02.02</FILE_NAME_CPF>
    <FILE_NAME_BPF_OLI>LO9BPF20240616165050_20240616171843.02</FILE_NAME_BPF_OLI>
    <FILE_NAME_BPF_TIRS>LT9BPF20240616164559_20240616182452.01</FILE_NAME_BPF_TIRS>
    <FILE_NAME_RLUT>LC09RLUT_20230701_20531231_02_10.h5</FILE_NAME_RLUT>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>160</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>7.390</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>5.361</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>5.086</GEOMETRIC_RMSE_MODEL_X>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>734.06683</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-60.61948</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>753.94604</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-62.26111</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>695.55688</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-57.43931</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>586.00403</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-48.39240</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>359.16302</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-29.65980</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>89.27634</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>-7.37247</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>30.08380</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-2.48433</RADIANCE_MINIMUM_BAND_7>
    <RADIANCE_MAXIMUM_BAND_8>661.33466</RADIANCE_MAXIMUM_BAND_8>
    <RADIANCE_MINIMUM_BAND_8>-54.61323</RADIANCE_MINIMUM_BAND_8>
    <RADIANCE_MAXIMUM_BAND_9>140.38083</RADIANCE_MAXIMUM_BAND_9>
    <RADIANCE_MINIMUM_BAND_9>-11.59269</RADIANCE_MINIMUM_BAND_9>
    <RADIANCE_MAXIMUM_BAND_10>25.00330</RADIANCE_MAXIMUM_BAND_10>
    <RADIANCE_MINIMUM_BAND_10>0.10038</RADIANCE_MINIMUM_BAND_10>
    <RADIANCE_MAXIMUM_BAND_11>22.97172</RADIANCE_MAXIMUM_BAND_11>
    <RADIANCE_MINIMUM_BAND_11>0.10035</RADIANCE_MINIMUM_BAND_11>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>1.210700</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.099980</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.210700</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.099980</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.210700</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.099980</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.210700</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.099980</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.210700</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.099980</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_6>1.210700</REFLECTANCE_MAXIMUM_BAND_6>
    <REFLECTANCE_MINIMUM_BAND_6>-0.099980</REFLECTANCE_MINIMUM_BAND_6>
    <REFLECTANCE_MAXIMUM_BAND_7>1.210700</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.099980</REFLECTANCE_MINIMUM_BAND_7>
    <REFLECTANCE_MAXIMUM_BAND_8>1.210700</REFLECTANCE_MAXIMUM_BAND_8>
    <REFLECTANCE_MINIMUM_BAND_8>-0.099980</REFLECTANCE_MINIMUM_BAND_8>
    <REFLECTANCE_MAXIMUM_BAND_9>1.210700</REFLECTANCE_MAXIMUM_BAND_9>
    <REFLECTANCE_MINIMUM_BAND_9>-0.099980</REFLECTANCE_MINIMUM_BAND_9>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>65535</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_8>65535</QUANTIZE_CAL_MAX_BAND_8>
    <QUANTIZE_CAL_MIN_BAND_8>1</QUANTIZE_CAL_MIN_BAND_8>
    <QUANTIZE_CAL_MAX_BAND_9>65535</QUANTIZE_CAL_MAX_BAND_9>
    <QUANTIZE_CAL_MIN_BAND_9>1</QUANTIZE_CAL_MIN_BAND_9>
    <QUANTIZE_CAL_MAX_BAND_10>65535</QUANTIZE_CAL_MAX_BAND_10>
    <QUANTIZE_CAL_MIN_BAND_10>1</QUANTIZE_CAL_MIN_BAND_10>
    <QUANTIZE_CAL_MAX_BAND_11>65535</QUANTIZE_CAL_MAX_BAND_11>
    <QUANTIZE_CAL_MIN_BAND_11>1</QUANTIZE_CAL_MIN_BAND_11>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>1.2126E-02</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>1.2455E-02</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>1.1490E-02</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>9.6804E-03</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>5.9331E-03</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>1.4748E-03</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>4.9697E-04</RADIANCE_MULT_BAND_7>
    <RADIANCE_MULT_BAND_8>1.0925E-02</RADIANCE_MULT_BAND_8>
    <RADIANCE_MULT_BAND_9>2.3190E-03</RADIANCE_MULT_BAND_9>
    <RADIANCE_MULT_BAND_10>3.8000E-04</RADIANCE_MULT_BAND_10>
    <RADIANCE_MULT_BAND_11>3.4900E-04</RADIANCE_MULT_BAND_11>
    <RADIANCE_ADD_BAND_1>-60.63160</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-62.27356</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-57.45080</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-48.40208</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-29.66573</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>-7.37394</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-2.48483</RADIANCE_ADD_BAND_7>
    <RADIANCE_ADD_BAND_8>-54.62416</RADIANCE_ADD_BAND_8>
    <RADIANCE_ADD_BAND_9>-11.59501</RADIANCE_ADD_BAND_9>
    <RADIANCE_ADD_BAND_10>0.10000</RADIANCE_ADD_BAND_10>
    <RADIANCE_ADD_BAND_11>0.10000</RADIANCE_ADD_BAND_11>
    <REFLECTANCE_MULT_BAND_1>2.0000E-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.0000E-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.0000E-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.0000E-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.0000E-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_6>2.0000E-05</REFLECTANCE_MULT_BAND_6>
    <REFLECTANCE_MULT_BAND_7>2.0000E-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_MULT_BAND_8>2.0000E-05</REFLECTANCE_MULT_BAND_8>
    <REFLECTANCE_MULT_BAND_9>2.0000E-05</REFLECTANCE_MULT_BAND_9>
    <REFLECTANCE_ADD_BAND_1>-0.100000</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.100000</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.100000</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.100000</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.100000</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_6>-0.100000</REFLECTANCE_ADD_BAND_6>
    <REFLECTANCE_ADD_BAND_7>-0.100000</REFLECTANCE_ADD_BAND_7>
    <REFLECTANCE_ADD_BAND_8>-0.100000</REFLECTANCE_ADD_BAND_8>
    <REFLECTANCE_ADD_BAND_9>-0.100000</REFLECTANCE_ADD_BAND_9>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_10>799.0284</K1_CONSTANT_BAND_10>
    <K2_CONSTANT_BAND_10>1329.2405</K2_CONSTANT_BAND_10>
    <K1_CONSTANT_BAND_11>475.6581</K1_CONSTANT_BAND_11>
    <K2_CONSTANT_BAND_11>1198.3494</K2_CONSTANT_BAND_11>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
  </LEVEL1_PROJECTION_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


etm_l1_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9TU80IG</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LE07_L1TP_230080_20231208_20240103_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LE07_L1TP_230080_20231208_20240103_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LE07_L1TP_230080_20231208_20240103_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LE07_L1TP_230080_20231208_20240103_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LE07_L1TP_230080_20231208_20240103_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6_VCID_1>LE07_L1TP_230080_20231208_20240103_02_T1_B6_VCID_1.TIF</FILE_NAME_BAND_6_VCID_1>
    <FILE_NAME_BAND_6_VCID_2>LE07_L1TP_230080_20231208_20240103_02_T1_B6_VCID_2.TIF</FILE_NAME_BAND_6_VCID_2>
    <FILE_NAME_BAND_7>LE07_L1TP_230080_20231208_20240103_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LE07_L1TP_230080_20231208_20240103_02_T1_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_QUALITY_L1_PIXEL>LE07_L1TP_230080_20231208_20240103_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LE07_L1TP_230080_20231208_20240103_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LE07_L1TP_230080_20231208_20240103_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LE07_L1TP_230080_20231208_20240103_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LE07_L1TP_230080_20231208_20240103_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LE07_L1TP_230080_20231208_20240103_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT8</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT8</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT8</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT8</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT8</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6_VCID_1>UINT8</DATA_TYPE_BAND_6_VCID_1>
    <DATA_TYPE_BAND_6_VCID_2>UINT8</DATA_TYPE_BAND_6_VCID_2>
    <DATA_TYPE_BAND_7>UINT8</DATA_TYPE_BAND_7>
    <DATA_TYPE_BAND_8>UINT8</DATA_TYPE_BAND_8>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_7</SPACECRAFT_ID>
    <SENSOR_ID>ETM</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>230</WRS_PATH>
    <WRS_ROW>080</WRS_ROW>
    <DATE_ACQUIRED>2023-12-08</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>11:44:51.2868783Z</SCENE_CENTER_TIME>
    <STATION_ID>ASN</STATION_ID>
    <CLOUD_COVER>10.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>10.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>9</IMAGE_QUALITY>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>Y</SATURATION_BAND_2>
    <SATURATION_BAND_3>Y</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6_VCID_1>N</SATURATION_BAND_6_VCID_1>
    <SATURATION_BAND_6_VCID_2>N</SATURATION_BAND_6_VCID_2>
    <SATURATION_BAND_7>Y</SATURATION_BAND_7>
    <SATURATION_BAND_8>N</SATURATION_BAND_8>
    <SUN_AZIMUTH>100.58959827</SUN_AZIMUTH>
    <SUN_ELEVATION>30.88235160</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>0.9850987</EARTH_SUN_DISTANCE>
    <SENSOR_MODE>BUMPER</SENSOR_MODE>
    <SENSOR_MODE_SLC>OFF</SENSOR_MODE_SLC>
    <SENSOR_ANOMALIES>NONE</SENSOR_ANOMALIES>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>20</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <PANCHROMATIC_LINES>200</PANCHROMATIC_LINES>
    <PANCHROMATIC_SAMPLES>200</PANCHROMATIC_SAMPLES>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>-27.92335</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-65.63282</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>-27.94841</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>-63.17282</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>-29.81408</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-65.68095</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>-29.84118</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>-63.17598</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>240900.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>-3091500.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>483000.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>-3091500.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>240900.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>-3301200.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>483000.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>-3301200.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9TU80IG</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1832924_00398</REQUEST_ID>
    <LANDSAT_SCENE_ID>LE72300802023342ASN00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LE07_L1TP_230080_20231208_20240103_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2024-01-03T11:31:35Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.3.1</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LE07_L1TP_230080_20231208_20240103_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LE07_L1TP_230080_20231208_20240103_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LE07_L1TP_230080_20231208_20240103_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LE07_L1TP_230080_20231208_20240103_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6_VCID_1>LE07_L1TP_230080_20231208_20240103_02_T1_B6_VCID_1.TIF</FILE_NAME_BAND_6_VCID_1>
    <FILE_NAME_BAND_6_VCID_2>LE07_L1TP_230080_20231208_20240103_02_T1_B6_VCID_2.TIF</FILE_NAME_BAND_6_VCID_2>
    <FILE_NAME_BAND_7>LE07_L1TP_230080_20231208_20240103_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LE07_L1TP_230080_20231208_20240103_02_T1_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_QUALITY_L1_PIXEL>LE07_L1TP_230080_20231208_20240103_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LE07_L1TP_230080_20231208_20240103_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LE07_L1TP_230080_20231208_20240103_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LE07_L1TP_230080_20231208_20240103_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LE07_L1TP_230080_20231208_20240103_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LE07_L1TP_230080_20231208_20240103_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LE07_L1TP_230080_20231208_20240103_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LE07CPF_20231001_20231231_02.07</FILE_NAME_CPF>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>590</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>4.218</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>3.115</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>2.844</GEOMETRIC_RMSE_MODEL_X>
    <EPHEMERIS_TYPE>DEFINITIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>191.600</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-6.200</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>196.500</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-6.400</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>152.900</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-5.000</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>241.100</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-5.100</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>31.060</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-1.000</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6_VCID_1>17.040</RADIANCE_MAXIMUM_BAND_6_VCID_1>
    <RADIANCE_MINIMUM_BAND_6_VCID_1>0.000</RADIANCE_MINIMUM_BAND_6_VCID_1>
    <RADIANCE_MAXIMUM_BAND_6_VCID_2>12.650</RADIANCE_MAXIMUM_BAND_6_VCID_2>
    <RADIANCE_MINIMUM_BAND_6_VCID_2>3.200</RADIANCE_MINIMUM_BAND_6_VCID_2>
    <RADIANCE_MAXIMUM_BAND_7>10.800</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-0.350</RADIANCE_MINIMUM_BAND_7>
    <RADIANCE_MAXIMUM_BAND_8>243.100</RADIANCE_MAXIMUM_BAND_8>
    <RADIANCE_MINIMUM_BAND_8>-4.700</RADIANCE_MINIMUM_BAND_8>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>0.286898</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.009284</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>0.322771</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.010513</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>0.305666</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.009996</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>0.686305</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.014517</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>0.427308</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.013758</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>0.404690</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.013115</REFLECTANCE_MINIMUM_BAND_7>
    <REFLECTANCE_MAXIMUM_BAND_8>0.561888</REFLECTANCE_MAXIMUM_BAND_8>
    <REFLECTANCE_MINIMUM_BAND_8>-0.010863</REFLECTANCE_MINIMUM_BAND_8>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>255</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>255</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>255</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>255</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6_VCID_1>255</QUANTIZE_CAL_MAX_BAND_6_VCID_1>
    <QUANTIZE_CAL_MIN_BAND_6_VCID_1>1</QUANTIZE_CAL_MIN_BAND_6_VCID_1>
    <QUANTIZE_CAL_MAX_BAND_6_VCID_2>255</QUANTIZE_CAL_MAX_BAND_6_VCID_2>
    <QUANTIZE_CAL_MIN_BAND_6_VCID_2>1</QUANTIZE_CAL_MIN_BAND_6_VCID_2>
    <QUANTIZE_CAL_MAX_BAND_7>255</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_8>255</QUANTIZE_CAL_MAX_BAND_8>
    <QUANTIZE_CAL_MIN_BAND_8>1</QUANTIZE_CAL_MIN_BAND_8>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>7.7874E-01</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>7.9882E-01</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>6.2165E-01</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>9.6929E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>1.2622E-01</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6_VCID_1>6.7087E-02</RADIANCE_MULT_BAND_6_VCID_1>
    <RADIANCE_MULT_BAND_6_VCID_2>3.7205E-02</RADIANCE_MULT_BAND_6_VCID_2>
    <RADIANCE_MULT_BAND_7>4.3898E-02</RADIANCE_MULT_BAND_7>
    <RADIANCE_MULT_BAND_8>9.7559E-01</RADIANCE_MULT_BAND_8>
    <RADIANCE_ADD_BAND_1>-6.97874</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-7.19882</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-5.62165</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-6.06929</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-1.12622</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6_VCID_1>-0.06709</RADIANCE_ADD_BAND_6_VCID_1>
    <RADIANCE_ADD_BAND_6_VCID_2>3.16280</RADIANCE_ADD_BAND_6_VCID_2>
    <RADIANCE_ADD_BAND_7>-0.39390</RADIANCE_ADD_BAND_7>
    <RADIANCE_ADD_BAND_8>-5.67559</RADIANCE_ADD_BAND_8>
    <REFLECTANCE_MULT_BAND_1>1.1661E-03</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>1.3121E-03</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>1.2428E-03</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.7591E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>1.7365E-03</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>1.6449E-03</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_MULT_BAND_8>2.2549E-03</REFLECTANCE_MULT_BAND_8>
    <REFLECTANCE_ADD_BAND_1>-0.010450</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.011825</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.011238</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.017277</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.015494</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.014760</REFLECTANCE_ADD_BAND_7>
    <REFLECTANCE_ADD_BAND_8>-0.013118</REFLECTANCE_ADD_BAND_8>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_6_VCID_1>666.09</K1_CONSTANT_BAND_6_VCID_1>
    <K2_CONSTANT_BAND_6_VCID_1>1282.71</K2_CONSTANT_BAND_6_VCID_1>
    <K1_CONSTANT_BAND_6_VCID_2>666.09</K1_CONSTANT_BAND_6_VCID_2>
    <K2_CONSTANT_BAND_6_VCID_2>1282.71</K2_CONSTANT_BAND_6_VCID_2>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>20</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <SCAN_GAP_INTERPOLATION>2.0</SCAN_GAP_INTERPOLATION>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <CORRECTION_GAIN_BAND_1>CPF</CORRECTION_GAIN_BAND_1>
    <CORRECTION_GAIN_BAND_2>CPF</CORRECTION_GAIN_BAND_2>
    <CORRECTION_GAIN_BAND_3>CPF</CORRECTION_GAIN_BAND_3>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <CORRECTION_GAIN_BAND_5>CPF</CORRECTION_GAIN_BAND_5>
    <CORRECTION_GAIN_BAND_6_VCID_1>CPF</CORRECTION_GAIN_BAND_6_VCID_1>
    <CORRECTION_GAIN_BAND_6_VCID_2>CPF</CORRECTION_GAIN_BAND_6_VCID_2>
    <CORRECTION_GAIN_BAND_7>CPF</CORRECTION_GAIN_BAND_7>
    <CORRECTION_GAIN_BAND_8>CPF</CORRECTION_GAIN_BAND_8>
    <CORRECTION_BIAS_BAND_1>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_1>
    <CORRECTION_BIAS_BAND_2>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_2>
    <CORRECTION_BIAS_BAND_3>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_3>
    <CORRECTION_BIAS_BAND_4>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_4>
    <CORRECTION_BIAS_BAND_5>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_5>
    <CORRECTION_BIAS_BAND_6_VCID_1>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_6_VCID_1>
    <CORRECTION_BIAS_BAND_6_VCID_2>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_6_VCID_2>
    <CORRECTION_BIAS_BAND_7>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_7>
    <CORRECTION_BIAS_BAND_8>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_8>
    <GAIN_BAND_1>H</GAIN_BAND_1>
    <GAIN_BAND_2>H</GAIN_BAND_2>
    <GAIN_BAND_3>H</GAIN_BAND_3>
    <GAIN_BAND_4>L</GAIN_BAND_4>
    <GAIN_BAND_5>H</GAIN_BAND_5>
    <GAIN_BAND_6_VCID_1>L</GAIN_BAND_6_VCID_1>
    <GAIN_BAND_6_VCID_2>H</GAIN_BAND_6_VCID_2>
    <GAIN_BAND_7>H</GAIN_BAND_7>
    <GAIN_BAND_8>L</GAIN_BAND_8>
    <GAIN_CHANGE_BAND_1>HH</GAIN_CHANGE_BAND_1>
    <GAIN_CHANGE_BAND_2>HH</GAIN_CHANGE_BAND_2>
    <GAIN_CHANGE_BAND_3>HH</GAIN_CHANGE_BAND_3>
    <GAIN_CHANGE_BAND_4>LL</GAIN_CHANGE_BAND_4>
    <GAIN_CHANGE_BAND_5>HH</GAIN_CHANGE_BAND_5>
    <GAIN_CHANGE_BAND_6_VCID_1>LL</GAIN_CHANGE_BAND_6_VCID_1>
    <GAIN_CHANGE_BAND_6_VCID_2>HH</GAIN_CHANGE_BAND_6_VCID_2>
    <GAIN_CHANGE_BAND_7>HH</GAIN_CHANGE_BAND_7>
    <GAIN_CHANGE_BAND_8>LL</GAIN_CHANGE_BAND_8>
    <GAIN_CHANGE_SCAN_BAND_1>0</GAIN_CHANGE_SCAN_BAND_1>
    <GAIN_CHANGE_SCAN_BAND_2>0</GAIN_CHANGE_SCAN_BAND_2>
    <GAIN_CHANGE_SCAN_BAND_3>0</GAIN_CHANGE_SCAN_BAND_3>
    <GAIN_CHANGE_SCAN_BAND_4>0</GAIN_CHANGE_SCAN_BAND_4>
    <GAIN_CHANGE_SCAN_BAND_5>0</GAIN_CHANGE_SCAN_BAND_5>
    <GAIN_CHANGE_SCAN_BAND_6_VCID_1>0</GAIN_CHANGE_SCAN_BAND_6_VCID_1>
    <GAIN_CHANGE_SCAN_BAND_6_VCID_2>0</GAIN_CHANGE_SCAN_BAND_6_VCID_2>
    <GAIN_CHANGE_SCAN_BAND_7>0</GAIN_CHANGE_SCAN_BAND_7>
    <GAIN_CHANGE_SCAN_BAND_8>0</GAIN_CHANGE_SCAN_BAND_8>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


etm_l2_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9C7I13B</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LE07_L2SP_028030_20230817_20230912_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_ST_B6>LE07_L2SP_028030_20230817_20230912_02_T1_ST_B6.TIF</FILE_NAME_BAND_ST_B6>
    <FILE_NAME_BAND_7>LE07_L2SP_028030_20230817_20230912_02_T1_SR_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_THERMAL_RADIANCE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_TRAD.TIF</FILE_NAME_THERMAL_RADIANCE>
    <FILE_NAME_UPWELL_RADIANCE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_URAD.TIF</FILE_NAME_UPWELL_RADIANCE>
    <FILE_NAME_DOWNWELL_RADIANCE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_DRAD.TIF</FILE_NAME_DOWNWELL_RADIANCE>
    <FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_ATRAN.TIF</FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>
    <FILE_NAME_EMISSIVITY>LE07_L2SP_028030_20230817_20230912_02_T1_ST_EMIS.TIF</FILE_NAME_EMISSIVITY>
    <FILE_NAME_EMISSIVITY_STDEV>LE07_L2SP_028030_20230817_20230912_02_T1_ST_EMSD.TIF</FILE_NAME_EMISSIVITY_STDEV>
    <FILE_NAME_CLOUD_DISTANCE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_CDIST.TIF</FILE_NAME_CLOUD_DISTANCE>
    <FILE_NAME_ATMOSPHERIC_OPACITY>LE07_L2SP_028030_20230817_20230912_02_T1_SR_ATMOS_OPACITY.TIF</FILE_NAME_ATMOSPHERIC_OPACITY>
    <FILE_NAME_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>LE07_L2SP_028030_20230817_20230912_02_T1_SR_CLOUD_QA.TIF</FILE_NAME_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>
    <FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>LE07_L2SP_028030_20230817_20230912_02_T1_ST_QA.TIF</FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>
    <FILE_NAME_QUALITY_L1_PIXEL>LE07_L2SP_028030_20230817_20230912_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LE07_L2SP_028030_20230817_20230912_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LE07_L2SP_028030_20230817_20230912_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_METADATA_ODL>LE07_L2SP_028030_20230817_20230912_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LE07_L2SP_028030_20230817_20230912_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT16</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT16</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT16</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT16</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT16</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_ST_B6>UINT16</DATA_TYPE_BAND_ST_B6>
    <DATA_TYPE_BAND_7>UINT16</DATA_TYPE_BAND_7>
    <DATA_TYPE_THERMAL_RADIANCE>INT16</DATA_TYPE_THERMAL_RADIANCE>
    <DATA_TYPE_UPWELL_RADIANCE>INT16</DATA_TYPE_UPWELL_RADIANCE>
    <DATA_TYPE_DOWNWELL_RADIANCE>INT16</DATA_TYPE_DOWNWELL_RADIANCE>
    <DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>INT16</DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>
    <DATA_TYPE_EMISSIVITY>INT16</DATA_TYPE_EMISSIVITY>
    <DATA_TYPE_EMISSIVITY_STDEV>INT16</DATA_TYPE_EMISSIVITY_STDEV>
    <DATA_TYPE_CLOUD_DISTANCE>INT16</DATA_TYPE_CLOUD_DISTANCE>
    <DATA_TYPE_ATMOSPHERIC_OPACITY>INT16</DATA_TYPE_ATMOSPHERIC_OPACITY>
    <DATA_TYPE_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>UINT8</DATA_TYPE_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>
    <DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>INT16</DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_7</SPACECRAFT_ID>
    <SENSOR_ID>ETM</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>028</WRS_PATH>
    <WRS_ROW>030</WRS_ROW>
    <DATE_ACQUIRED>2023-08-17</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>14:54:20.0400998Z</SCENE_CENTER_TIME>
    <STATION_ID>ASN</STATION_ID>
    <CLOUD_COVER>0.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>0.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>9</IMAGE_QUALITY>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>Y</SATURATION_BAND_2>
    <SATURATION_BAND_3>Y</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6_VCID_1>N</SATURATION_BAND_6_VCID_1>
    <SATURATION_BAND_6_VCID_2>Y</SATURATION_BAND_6_VCID_2>
    <SATURATION_BAND_7>Y</SATURATION_BAND_7>
    <SATURATION_BAND_8>N</SATURATION_BAND_8>
    <SUN_AZIMUTH>105.82706424</SUN_AZIMUTH>
    <SUN_ELEVATION>35.09902700</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0124651</EARTH_SUN_DISTANCE>
    <SENSOR_MODE>BUMPER</SENSOR_MODE>
    <SENSOR_MODE_SLC>OFF</SENSOR_MODE_SLC>
    <SENSOR_ANOMALIES>NONE</SENSOR_ANOMALIES>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>15</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>44.17250</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-98.18108</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>44.27187</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>-95.04367</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>42.17058</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-98.01413</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>42.26326</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>-94.97752</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>85800.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>4904100.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>336900.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>4904100.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>85800.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>4680900.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>336900.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>4680900.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL2_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9C7I13B</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1786896_00133</REQUEST_ID>
    <LANDSAT_PRODUCT_ID>LE07_L2SP_028030_20230817_20230912_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2023-09-12T21:14:59Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.3.0</PROCESSING_SOFTWARE_VERSION>
    <ALGORITHM_SOURCE_SURFACE_REFLECTANCE>LEDAPS_3.4.0</ALGORITHM_SOURCE_SURFACE_REFLECTANCE>
    <DATA_SOURCE_OZONE>TOMS</DATA_SOURCE_OZONE>
    <DATA_SOURCE_PRESSURE>NCEP</DATA_SOURCE_PRESSURE>
    <DATA_SOURCE_WATER_VAPOR>NCEP</DATA_SOURCE_WATER_VAPOR>
    <DATA_SOURCE_AIR_TEMPERATURE>NCEP</DATA_SOURCE_AIR_TEMPERATURE>
    <ALGORITHM_SOURCE_SURFACE_TEMPERATURE>st_1.5.0</ALGORITHM_SOURCE_SURFACE_TEMPERATURE>
    <DATA_SOURCE_REANALYSIS>GEOS-5 FP-IT</DATA_SOURCE_REANALYSIS>
  </LEVEL2_PROCESSING_RECORD>
  <LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
    <REFLECTANCE_MAXIMUM_BAND_1>1.602213</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.199972</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.602213</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.199972</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.602213</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.199972</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.602213</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.199972</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.602213</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.199972</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>1.602213</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.199972</REFLECTANCE_MINIMUM_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <REFLECTANCE_MULT_BAND_1>2.75e-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.75e-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.75e-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.75e-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.75e-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>2.75e-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_1>-0.2</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.2</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.2</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.2</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.2</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.2</REFLECTANCE_ADD_BAND_7>
  </LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
  <LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
    <TEMPERATURE_MAXIMUM_BAND_ST_B6>372.999941</TEMPERATURE_MAXIMUM_BAND_ST_B6>
    <TEMPERATURE_MINIMUM_BAND_ST_B6>149.003418</TEMPERATURE_MINIMUM_BAND_ST_B6>
    <QUANTIZE_CAL_MAXIMUM_BAND_ST_B6>65535</QUANTIZE_CAL_MAXIMUM_BAND_ST_B6>
    <QUANTIZE_CAL_MINIMUM_BAND_ST_B6>1</QUANTIZE_CAL_MINIMUM_BAND_ST_B6>
    <TEMPERATURE_MULT_BAND_ST_B6>0.00341802</TEMPERATURE_MULT_BAND_ST_B6>
    <TEMPERATURE_ADD_BAND_ST_B6>149.0</TEMPERATURE_ADD_BAND_ST_B6>
  </LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9TU80IG</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>1786896_00133</REQUEST_ID>
    <LANDSAT_SCENE_ID>LE70280302023229ASN00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LE07_L1TP_028030_20230817_20230912_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2023-09-12T21:03:18Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_16.3.0</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LE07_L1TP_028030_20230817_20230912_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LE07_L1TP_028030_20230817_20230912_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LE07_L1TP_028030_20230817_20230912_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LE07_L1TP_028030_20230817_20230912_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LE07_L1TP_028030_20230817_20230912_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6_VCID_1>LE07_L1TP_028030_20230817_20230912_02_T1_B6_VCID_1.TIF</FILE_NAME_BAND_6_VCID_1>
    <FILE_NAME_BAND_6_VCID_2>LE07_L1TP_028030_20230817_20230912_02_T1_B6_VCID_2.TIF</FILE_NAME_BAND_6_VCID_2>
    <FILE_NAME_BAND_7>LE07_L1TP_028030_20230817_20230912_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LE07_L1TP_028030_20230817_20230912_02_T1_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_QUALITY_L1_PIXEL>LE07_L1TP_028030_20230817_20230912_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LE07_L1TP_028030_20230817_20230912_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LE07_L1TP_028030_20230817_20230912_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LE07_L1TP_028030_20230817_20230912_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LE07_L1TP_028030_20230817_20230912_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LE07_L1TP_028030_20230817_20230912_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LE07_L1TP_028030_20230817_20230912_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LE07_L1TP_028030_20230817_20230912_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LE07_L1TP_028030_20230817_20230912_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LE07_L1TP_028030_20230817_20230912_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LE07CPF_20230701_20230930_02.05</FILE_NAME_CPF>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>435</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>5.332</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>4.119</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>3.386</GEOMETRIC_RMSE_MODEL_X>
    <EPHEMERIS_TYPE>DEFINITIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>191.600</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-6.200</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>196.500</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-6.400</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>152.900</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-5.000</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>241.100</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-5.100</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>31.060</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-1.000</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6_VCID_1>17.040</RADIANCE_MAXIMUM_BAND_6_VCID_1>
    <RADIANCE_MINIMUM_BAND_6_VCID_1>0.000</RADIANCE_MINIMUM_BAND_6_VCID_1>
    <RADIANCE_MAXIMUM_BAND_6_VCID_2>12.650</RADIANCE_MAXIMUM_BAND_6_VCID_2>
    <RADIANCE_MINIMUM_BAND_6_VCID_2>3.200</RADIANCE_MINIMUM_BAND_6_VCID_2>
    <RADIANCE_MAXIMUM_BAND_7>16.540</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-0.350</RADIANCE_MINIMUM_BAND_7>
    <RADIANCE_MAXIMUM_BAND_8>243.100</RADIANCE_MAXIMUM_BAND_8>
    <RADIANCE_MINIMUM_BAND_8>-4.700</RADIANCE_MINIMUM_BAND_8>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>0.303059</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.009807</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>0.340953</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.011105</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>0.322885</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.010559</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>0.724966</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.015335</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>0.451379</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.014532</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>0.654688</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.013854</REFLECTANCE_MINIMUM_BAND_7>
    <REFLECTANCE_MAXIMUM_BAND_8>0.593540</REFLECTANCE_MAXIMUM_BAND_8>
    <REFLECTANCE_MINIMUM_BAND_8>-0.011475</REFLECTANCE_MINIMUM_BAND_8>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>255</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>255</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>255</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>255</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6_VCID_1>255</QUANTIZE_CAL_MAX_BAND_6_VCID_1>
    <QUANTIZE_CAL_MIN_BAND_6_VCID_1>1</QUANTIZE_CAL_MIN_BAND_6_VCID_1>
    <QUANTIZE_CAL_MAX_BAND_6_VCID_2>255</QUANTIZE_CAL_MAX_BAND_6_VCID_2>
    <QUANTIZE_CAL_MIN_BAND_6_VCID_2>1</QUANTIZE_CAL_MIN_BAND_6_VCID_2>
    <QUANTIZE_CAL_MAX_BAND_7>255</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_8>255</QUANTIZE_CAL_MAX_BAND_8>
    <QUANTIZE_CAL_MIN_BAND_8>1</QUANTIZE_CAL_MIN_BAND_8>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>7.7874E-01</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>7.9882E-01</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>6.2165E-01</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>9.6929E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>1.2622E-01</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6_VCID_1>6.7087E-02</RADIANCE_MULT_BAND_6_VCID_1>
    <RADIANCE_MULT_BAND_6_VCID_2>3.7205E-02</RADIANCE_MULT_BAND_6_VCID_2>
    <RADIANCE_MULT_BAND_7>6.6496E-02</RADIANCE_MULT_BAND_7>
    <RADIANCE_MULT_BAND_8>9.7559E-01</RADIANCE_MULT_BAND_8>
    <RADIANCE_ADD_BAND_1>-6.97874</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-7.19882</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-5.62165</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-6.06929</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-1.12622</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6_VCID_1>-0.06709</RADIANCE_ADD_BAND_6_VCID_1>
    <RADIANCE_ADD_BAND_6_VCID_2>3.16280</RADIANCE_ADD_BAND_6_VCID_2>
    <RADIANCE_ADD_BAND_7>-0.41650</RADIANCE_ADD_BAND_7>
    <RADIANCE_ADD_BAND_8>-5.67559</RADIANCE_ADD_BAND_8>
    <REFLECTANCE_MULT_BAND_1>1.2318E-03</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>1.3861E-03</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>1.3128E-03</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.9146E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>1.8343E-03</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>2.6321E-03</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_MULT_BAND_8>2.3820E-03</REFLECTANCE_MULT_BAND_8>
    <REFLECTANCE_ADD_BAND_1>-0.011038</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.012491</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.011871</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.018250</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.016367</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.016486</REFLECTANCE_ADD_BAND_7>
    <REFLECTANCE_ADD_BAND_8>-0.013857</REFLECTANCE_ADD_BAND_8>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_6_VCID_1>666.09</K1_CONSTANT_BAND_6_VCID_1>
    <K2_CONSTANT_BAND_6_VCID_1>1282.71</K2_CONSTANT_BAND_6_VCID_1>
    <K1_CONSTANT_BAND_6_VCID_2>666.09</K1_CONSTANT_BAND_6_VCID_2>
    <K2_CONSTANT_BAND_6_VCID_2>1282.71</K2_CONSTANT_BAND_6_VCID_2>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>15</UTM_ZONE>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <SCAN_GAP_INTERPOLATION>2.0</SCAN_GAP_INTERPOLATION>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <CORRECTION_GAIN_BAND_1>CPF</CORRECTION_GAIN_BAND_1>
    <CORRECTION_GAIN_BAND_2>CPF</CORRECTION_GAIN_BAND_2>
    <CORRECTION_GAIN_BAND_3>CPF</CORRECTION_GAIN_BAND_3>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <CORRECTION_GAIN_BAND_5>CPF</CORRECTION_GAIN_BAND_5>
    <CORRECTION_GAIN_BAND_6_VCID_1>CPF</CORRECTION_GAIN_BAND_6_VCID_1>
    <CORRECTION_GAIN_BAND_6_VCID_2>CPF</CORRECTION_GAIN_BAND_6_VCID_2>
    <CORRECTION_GAIN_BAND_7>CPF</CORRECTION_GAIN_BAND_7>
    <CORRECTION_GAIN_BAND_8>CPF</CORRECTION_GAIN_BAND_8>
    <CORRECTION_BIAS_BAND_1>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_1>
    <CORRECTION_BIAS_BAND_2>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_2>
    <CORRECTION_BIAS_BAND_3>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_3>
    <CORRECTION_BIAS_BAND_4>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_4>
    <CORRECTION_BIAS_BAND_5>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_5>
    <CORRECTION_BIAS_BAND_6_VCID_1>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_6_VCID_1>
    <CORRECTION_BIAS_BAND_6_VCID_2>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_6_VCID_2>
    <CORRECTION_BIAS_BAND_7>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_7>
    <CORRECTION_BIAS_BAND_8>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_8>
    <GAIN_BAND_1>H</GAIN_BAND_1>
    <GAIN_BAND_2>H</GAIN_BAND_2>
    <GAIN_BAND_3>H</GAIN_BAND_3>
    <GAIN_BAND_4>L</GAIN_BAND_4>
    <GAIN_BAND_5>H</GAIN_BAND_5>
    <GAIN_BAND_6_VCID_1>L</GAIN_BAND_6_VCID_1>
    <GAIN_BAND_6_VCID_2>H</GAIN_BAND_6_VCID_2>
    <GAIN_BAND_7>L</GAIN_BAND_7>
    <GAIN_BAND_8>L</GAIN_BAND_8>
    <GAIN_CHANGE_BAND_1>HH</GAIN_CHANGE_BAND_1>
    <GAIN_CHANGE_BAND_2>HH</GAIN_CHANGE_BAND_2>
    <GAIN_CHANGE_BAND_3>HH</GAIN_CHANGE_BAND_3>
    <GAIN_CHANGE_BAND_4>LL</GAIN_CHANGE_BAND_4>
    <GAIN_CHANGE_BAND_5>HH</GAIN_CHANGE_BAND_5>
    <GAIN_CHANGE_BAND_6_VCID_1>LL</GAIN_CHANGE_BAND_6_VCID_1>
    <GAIN_CHANGE_BAND_6_VCID_2>HH</GAIN_CHANGE_BAND_6_VCID_2>
    <GAIN_CHANGE_BAND_7>LL</GAIN_CHANGE_BAND_7>
    <GAIN_CHANGE_BAND_8>LL</GAIN_CHANGE_BAND_8>
    <GAIN_CHANGE_SCAN_BAND_1>0</GAIN_CHANGE_SCAN_BAND_1>
    <GAIN_CHANGE_SCAN_BAND_2>0</GAIN_CHANGE_SCAN_BAND_2>
    <GAIN_CHANGE_SCAN_BAND_3>0</GAIN_CHANGE_SCAN_BAND_3>
    <GAIN_CHANGE_SCAN_BAND_4>0</GAIN_CHANGE_SCAN_BAND_4>
    <GAIN_CHANGE_SCAN_BAND_5>0</GAIN_CHANGE_SCAN_BAND_5>
    <GAIN_CHANGE_SCAN_BAND_6_VCID_1>0</GAIN_CHANGE_SCAN_BAND_6_VCID_1>
    <GAIN_CHANGE_SCAN_BAND_6_VCID_2>0</GAIN_CHANGE_SCAN_BAND_6_VCID_2>
    <GAIN_CHANGE_SCAN_BAND_7>0</GAIN_CHANGE_SCAN_BAND_7>
    <GAIN_CHANGE_SCAN_BAND_8>0</GAIN_CHANGE_SCAN_BAND_8>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


tm_l1_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P918ROHC</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LT04_L1TP_143021_19890818_20200916_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LT04_L1TP_143021_19890818_20200916_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LT04_L1TP_143021_19890818_20200916_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LT04_L1TP_143021_19890818_20200916_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LT04_L1TP_143021_19890818_20200916_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LT04_L1TP_143021_19890818_20200916_02_T1_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LT04_L1TP_143021_19890818_20200916_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_QUALITY_L1_PIXEL>LT04_L1TP_143021_19890818_20200916_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LT04_L1TP_143021_19890818_20200916_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LT04_L1TP_143021_19890818_20200916_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LT04_L1TP_143021_19890818_20200916_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LT04_L1TP_143021_19890818_20200916_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LT04_L1TP_143021_19890818_20200916_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_VERIFY_REPORT>LT04_L1TP_143021_19890818_20200916_02_T1_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LT04_L1TP_143021_19890818_20200916_02_T1_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_TYPE_BAND_1>UINT8</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT8</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT8</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT8</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT8</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6>UINT8</DATA_TYPE_BAND_6>
    <DATA_TYPE_BAND_7>UINT8</DATA_TYPE_BAND_7>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_4</SPACECRAFT_ID>
    <SENSOR_ID>TM</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>143</WRS_PATH>
    <WRS_ROW>021</WRS_ROW>
    <DATE_ACQUIRED>1989-08-18</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>04:26:11.9550880Z</SCENE_CENTER_TIME>
    <STATION_ID>XXX</STATION_ID>
    <CLOUD_COVER>10.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>10.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>9</IMAGE_QUALITY>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>Y</SATURATION_BAND_2>
    <SATURATION_BAND_3>Y</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>N</SATURATION_BAND_6>
    <SATURATION_BAND_7>Y</SATURATION_BAND_7>
    <SUN_AZIMUTH>149.14166856</SUN_AZIMUTH>
    <SUN_ELEVATION>43.85182285</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0122057</EARTH_SUN_DISTANCE>
    <SENSOR_MODE>SAM</SENSOR_MODE>
    <SENSOR_MODE_SLC>ON</SENSOR_MODE_SLC>
    <SENSOR_ANOMALIES>NONE</SENSOR_ANOMALIES>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>46</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>56.91211</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>90.07952</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>56.94129</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>94.11108</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>54.88218</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>90.22826</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>54.90923</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>94.05441</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>322200.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>6311400.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>567600.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>6311400.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>322200.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>6085200.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>567600.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>6085200.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P918ROHC</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>L2</REQUEST_ID>
    <LANDSAT_SCENE_ID>LT41430211989230XXX02</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LT04_L1TP_143021_19890818_20200916_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2020-09-16T12:08:23Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.3.1c</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LT04_L1TP_143021_19890818_20200916_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LT04_L1TP_143021_19890818_20200916_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LT04_L1TP_143021_19890818_20200916_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LT04_L1TP_143021_19890818_20200916_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LT04_L1TP_143021_19890818_20200916_02_T1_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LT04_L1TP_143021_19890818_20200916_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_QUALITY_L1_PIXEL>LT04_L1TP_143021_19890818_20200916_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LT04_L1TP_143021_19890818_20200916_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LT04_L1TP_143021_19890818_20200916_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LT04_L1TP_143021_19890818_20200916_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LT04_L1TP_143021_19890818_20200916_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LT04_L1TP_143021_19890818_20200916_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LT04_L1TP_143021_19890818_20200916_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LT04CPF_19890701_19890930_02.01</FILE_NAME_CPF>
    <FILE_NAME_VERIFY_REPORT>LT04_L1TP_143021_19890818_20200916_02_T1_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LT04_L1TP_143021_19890818_20200916_02_T1_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>918</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>4.609</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>3.369</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>3.145</GEOMETRIC_RMSE_MODEL_X>
    <GROUND_CONTROL_POINTS_VERIFY>2236</GROUND_CONTROL_POINTS_VERIFY>
    <GEOMETRIC_RMSE_VERIFY>0.233</GEOMETRIC_RMSE_VERIFY>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UL>0.195</GEOMETRIC_RMSE_VERIFY_QUAD_UL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UR>0.211</GEOMETRIC_RMSE_VERIFY_QUAD_UR>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LL>0.296</GEOMETRIC_RMSE_VERIFY_QUAD_LL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LR>0.247</GEOMETRIC_RMSE_VERIFY_QUAD_LR>
    <EPHEMERIS_TYPE>DEFINITIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>171.000</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-1.520</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>336.000</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-2.840</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>254.000</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-1.170</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>221.000</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-1.510</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>31.400</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-0.370</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>15.303</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>1.238</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>16.600</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-0.150</RADIANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>0.283277</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.002518</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>0.615188</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.005200</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>0.550547</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.002536</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>0.688620</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.004705</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>0.455881</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.005372</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>0.641894</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.005800</REFLECTANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>255</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>255</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>255</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>255</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>255</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>255</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>6.7921E-01</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>1.3340E+00</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>1.0046E+00</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>8.7602E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>1.2508E-01</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>5.5375E-02</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>6.5945E-02</RADIANCE_MULT_BAND_7>
    <RADIANCE_ADD_BAND_1>-2.19921</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-4.17402</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-2.17461</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-2.38602</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-0.49508</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>1.18243</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-0.21594</RADIANCE_ADD_BAND_7>
    <REFLECTANCE_MULT_BAND_1>1.1252E-03</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.4425E-03</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.1775E-03</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.7296E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>1.8160E-03</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>2.5500E-03</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_1>-0.003643</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.007642</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.004713</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.007435</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.007188</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.008350</REFLECTANCE_ADD_BAND_7>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_6>671.62</K1_CONSTANT_BAND_6>
    <K2_CONSTANT_BAND_6>1284.30</K2_CONSTANT_BAND_6>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>46</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <MAP_PROJECTION_L0RA>NA</MAP_PROJECTION_L0RA>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <DATA_TYPE_L0RP>TMR_L0RP</DATA_TYPE_L0RP>
    <CORRECTION_GAIN_BAND_1>CPF</CORRECTION_GAIN_BAND_1>
    <CORRECTION_GAIN_BAND_2>CPF</CORRECTION_GAIN_BAND_2>
    <CORRECTION_GAIN_BAND_3>CPF</CORRECTION_GAIN_BAND_3>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <CORRECTION_GAIN_BAND_5>CPF</CORRECTION_GAIN_BAND_5>
    <CORRECTION_GAIN_BAND_6>INTERNAL_CALIBRATION</CORRECTION_GAIN_BAND_6>
    <CORRECTION_GAIN_BAND_7>CPF</CORRECTION_GAIN_BAND_7>
    <CORRECTION_BIAS_BAND_1>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_1>
    <CORRECTION_BIAS_BAND_2>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_2>
    <CORRECTION_BIAS_BAND_3>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_3>
    <CORRECTION_BIAS_BAND_4>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_4>
    <CORRECTION_BIAS_BAND_5>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_5>
    <CORRECTION_BIAS_BAND_6>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_6>
    <CORRECTION_BIAS_BAND_7>INTERNAL_CALIBRATION</CORRECTION_BIAS_BAND_7>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


tm_l2_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9IAXOVV</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LT05_L2SP_165054_20110817_20200820_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_ST_B6>LT05_L2SP_165054_20110817_20200820_02_T1_ST_B6.TIF</FILE_NAME_BAND_ST_B6>
    <FILE_NAME_BAND_7>LT05_L2SP_165054_20110817_20200820_02_T1_SR_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_THERMAL_RADIANCE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_TRAD.TIF</FILE_NAME_THERMAL_RADIANCE>
    <FILE_NAME_UPWELL_RADIANCE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_URAD.TIF</FILE_NAME_UPWELL_RADIANCE>
    <FILE_NAME_DOWNWELL_RADIANCE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_DRAD.TIF</FILE_NAME_DOWNWELL_RADIANCE>
    <FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_ATRAN.TIF</FILE_NAME_ATMOSPHERIC_TRANSMITTANCE>
    <FILE_NAME_EMISSIVITY>LT05_L2SP_165054_20110817_20200820_02_T1_ST_EMIS.TIF</FILE_NAME_EMISSIVITY>
    <FILE_NAME_EMISSIVITY_STDEV>LT05_L2SP_165054_20110817_20200820_02_T1_ST_EMSD.TIF</FILE_NAME_EMISSIVITY_STDEV>
    <FILE_NAME_CLOUD_DISTANCE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_CDIST.TIF</FILE_NAME_CLOUD_DISTANCE>
    <FILE_NAME_ATMOSPHERIC_OPACITY>LT05_L2SP_165054_20110817_20200820_02_T1_SR_ATMOS_OPACITY.TIF</FILE_NAME_ATMOSPHERIC_OPACITY>
    <FILE_NAME_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>LT05_L2SP_165054_20110817_20200820_02_T1_SR_CLOUD_QA.TIF</FILE_NAME_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>
    <FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>LT05_L2SP_165054_20110817_20200820_02_T1_ST_QA.TIF</FILE_NAME_QUALITY_L2_SURFACE_TEMPERATURE>
    <FILE_NAME_QUALITY_L1_PIXEL>LT05_L2SP_165054_20110817_20200820_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LT05_L2SP_165054_20110817_20200820_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LT05_L2SP_165054_20110817_20200820_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_METADATA_ODL>LT05_L2SP_165054_20110817_20200820_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LT05_L2SP_165054_20110817_20200820_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT16</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT16</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT16</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT16</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT16</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_ST_B6>UINT16</DATA_TYPE_BAND_ST_B6>
    <DATA_TYPE_BAND_7>UINT16</DATA_TYPE_BAND_7>
    <DATA_TYPE_THERMAL_RADIANCE>INT16</DATA_TYPE_THERMAL_RADIANCE>
    <DATA_TYPE_UPWELL_RADIANCE>INT16</DATA_TYPE_UPWELL_RADIANCE>
    <DATA_TYPE_DOWNWELL_RADIANCE>INT16</DATA_TYPE_DOWNWELL_RADIANCE>
    <DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>INT16</DATA_TYPE_ATMOSPHERIC_TRANSMITTANCE>
    <DATA_TYPE_EMISSIVITY>INT16</DATA_TYPE_EMISSIVITY>
    <DATA_TYPE_EMISSIVITY_STDEV>INT16</DATA_TYPE_EMISSIVITY_STDEV>
    <DATA_TYPE_CLOUD_DISTANCE>INT16</DATA_TYPE_CLOUD_DISTANCE>
    <DATA_TYPE_ATMOSPHERIC_OPACITY>INT16</DATA_TYPE_ATMOSPHERIC_OPACITY>
    <DATA_TYPE_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>UINT8</DATA_TYPE_QUALITY_L2_SURFACE_REFLECTANCE_CLOUD>
    <DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>INT16</DATA_TYPE_QUALITY_L2_SURFACE_TEMPERATURE>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_5</SPACECRAFT_ID>
    <SENSOR_ID>TM</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>165</WRS_PATH>
    <WRS_ROW>054</WRS_ROW>
    <DATE_ACQUIRED>2011-08-17</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>07:10:40.4500880Z</SCENE_CENTER_TIME>
    <STATION_ID>MLK</STATION_ID>
    <CLOUD_COVER>1.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>1.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>9</IMAGE_QUALITY>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>N</SATURATION_BAND_2>
    <SATURATION_BAND_3>Y</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>N</SATURATION_BAND_6>
    <SATURATION_BAND_7>Y</SATURATION_BAND_7>
    <SUN_AZIMUTH>77.85712345</SUN_AZIMUTH>
    <SUN_ELEVATION>60.67425636</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0125021</EARTH_SUN_DISTANCE>
    <SENSOR_MODE>BUMPER</SENSOR_MODE>
    <SENSOR_MODE_SLC>ON</SENSOR_MODE_SLC>
    <SENSOR_ANOMALIES>NONE</SENSOR_ANOMALIES>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>38</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>100</THERMAL_LINES>
    <THERMAL_SAMPLES>100</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>9.62203</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>42.79763</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>9.62905</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>44.95716</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>7.73207</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>42.80862</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>7.73769</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>44.95738</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>258300.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>1064400.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>495300.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>1064400.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>258300.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>855300.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>495300.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>855300.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL2_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9IAXOVV</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>L2</REQUEST_ID>
    <LANDSAT_PRODUCT_ID>LT05_L2SP_165054_20110817_20200820_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L2SP</PROCESSING_LEVEL>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2020-08-20T17:04:37Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.3.1c</PROCESSING_SOFTWARE_VERSION>
    <ALGORITHM_SOURCE_SURFACE_REFLECTANCE>LEDAPS_3.4.0</ALGORITHM_SOURCE_SURFACE_REFLECTANCE>
    <DATA_SOURCE_OZONE>TOMS</DATA_SOURCE_OZONE>
    <DATA_SOURCE_PRESSURE>NCEP</DATA_SOURCE_PRESSURE>
    <DATA_SOURCE_WATER_VAPOR>NCEP</DATA_SOURCE_WATER_VAPOR>
    <DATA_SOURCE_AIR_TEMPERATURE>NCEP</DATA_SOURCE_AIR_TEMPERATURE>
    <ALGORITHM_SOURCE_SURFACE_TEMPERATURE>st_1.3.0</ALGORITHM_SOURCE_SURFACE_TEMPERATURE>
    <DATA_SOURCE_REANALYSIS>GEOS-5 FP-IT</DATA_SOURCE_REANALYSIS>
  </LEVEL2_PROCESSING_RECORD>
  <LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
    <REFLECTANCE_MAXIMUM_BAND_1>1.602213</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.199972</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.602213</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.199972</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.602213</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.199972</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.602213</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.199972</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.602213</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.199972</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>1.602213</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.199972</REFLECTANCE_MINIMUM_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <REFLECTANCE_MULT_BAND_1>2.75e-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.75e-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.75e-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.75e-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.75e-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>2.75e-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_1>-0.2</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.2</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.2</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.2</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.2</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.2</REFLECTANCE_ADD_BAND_7>
  </LEVEL2_SURFACE_REFLECTANCE_PARAMETERS>
  <LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
    <TEMPERATURE_MAXIMUM_BAND_ST_B6>372.999941</TEMPERATURE_MAXIMUM_BAND_ST_B6>
    <TEMPERATURE_MINIMUM_BAND_ST_B6>149.003418</TEMPERATURE_MINIMUM_BAND_ST_B6>
    <QUANTIZE_CAL_MAXIMUM_BAND_ST_B6>65535</QUANTIZE_CAL_MAXIMUM_BAND_ST_B6>
    <QUANTIZE_CAL_MINIMUM_BAND_ST_B6>1</QUANTIZE_CAL_MINIMUM_BAND_ST_B6>
    <TEMPERATURE_MULT_BAND_ST_B6>0.00341802</TEMPERATURE_MULT_BAND_ST_B6>
    <TEMPERATURE_ADD_BAND_ST_B6>149.0</TEMPERATURE_ADD_BAND_ST_B6>
  </LEVEL2_SURFACE_TEMPERATURE_PARAMETERS>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P918ROHC</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>L2</REQUEST_ID>
    <LANDSAT_SCENE_ID>LT51650542011229MLK00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LT05_L1TP_165054_20110817_20200820_02_T1</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T1</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2020-08-20T16:50:14Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.3.1c</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LT05_L1TP_165054_20110817_20200820_02_T1_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LT05_L1TP_165054_20110817_20200820_02_T1_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LT05_L1TP_165054_20110817_20200820_02_T1_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LT05_L1TP_165054_20110817_20200820_02_T1_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LT05_L1TP_165054_20110817_20200820_02_T1_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LT05_L1TP_165054_20110817_20200820_02_T1_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LT05_L1TP_165054_20110817_20200820_02_T1_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_QUALITY_L1_PIXEL>LT05_L1TP_165054_20110817_20200820_02_T1_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LT05_L1TP_165054_20110817_20200820_02_T1_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LT05_L1TP_165054_20110817_20200820_02_T1_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_ANGLE_COEFFICIENT>LT05_L1TP_165054_20110817_20200820_02_T1_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LT05_L1TP_165054_20110817_20200820_02_T1_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LT05_L1TP_165054_20110817_20200820_02_T1_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LT05_L1TP_165054_20110817_20200820_02_T1_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LT05_L1TP_165054_20110817_20200820_02_T1_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LT05_L1TP_165054_20110817_20200820_02_T1_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LT05_L1TP_165054_20110817_20200820_02_T1_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LT05CPF_20110701_20110930_02.01</FILE_NAME_CPF>
    <FILE_NAME_VERIFY_REPORT>LT05_L1TP_165054_20110817_20200820_02_T1_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LT05_L1TP_165054_20110817_20200820_02_T1_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>996</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>3.460</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>2.368</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>2.523</GEOMETRIC_RMSE_MODEL_X>
    <GROUND_CONTROL_POINTS_VERIFY>2414</GROUND_CONTROL_POINTS_VERIFY>
    <GEOMETRIC_RMSE_VERIFY>0.223</GEOMETRIC_RMSE_VERIFY>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UL>0.338</GEOMETRIC_RMSE_VERIFY_QUAD_UL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UR>0.267</GEOMETRIC_RMSE_VERIFY_QUAD_UR>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LL>0.219</GEOMETRIC_RMSE_VERIFY_QUAD_LL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LR>0.130</GEOMETRIC_RMSE_VERIFY_QUAD_LR>
    <EPHEMERIS_TYPE>DEFINITIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>193.000</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-1.520</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>365.000</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-2.840</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>264.000</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-1.170</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>221.000</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-1.510</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>30.200</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-0.370</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>15.303</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>1.238</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>16.500</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-0.150</RADIANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>0.319744</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.002518</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>0.668296</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.005200</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>0.570636</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.002529</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>0.689023</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.004708</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>0.464042</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.005685</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_7>0.646164</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.005874</REFLECTANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>255</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>255</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>255</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>255</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>255</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>255</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>7.6583E-01</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>1.4482E+00</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>1.0440E+00</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>8.7602E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>1.2035E-01</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>5.5375E-02</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>6.5551E-02</RADIANCE_MULT_BAND_7>
    <RADIANCE_ADD_BAND_1>-2.28583</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-4.28819</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-2.21398</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-2.38602</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-0.49035</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>1.18243</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-0.21555</RADIANCE_ADD_BAND_7>
    <REFLECTANCE_MULT_BAND_1>1.2687E-03</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.6516E-03</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.2566E-03</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.7312E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>1.8493E-03</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_7>2.5671E-03</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_1>-0.003787</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.007851</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.004786</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.007439</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.007535</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_7>-0.008441</REFLECTANCE_ADD_BAND_7>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_6>607.76</K1_CONSTANT_BAND_6>
    <K2_CONSTANT_BAND_6>1260.56</K2_CONSTANT_BAND_6>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>38</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <MAP_PROJECTION_L0RA>NA</MAP_PROJECTION_L0RA>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <DATA_TYPE_L0RP>TMR_L0RP</DATA_TYPE_L0RP>
    <CORRECTION_GAIN_BAND_1>CPF</CORRECTION_GAIN_BAND_1>
    <CORRECTION_GAIN_BAND_2>CPF</CORRECTION_GAIN_BAND_2>
    <CORRECTION_GAIN_BAND_3>CPF</CORRECTION_GAIN_BAND_3>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <CORRECTION_GAIN_BAND_5>CPF</CORRECTION_GAIN_BAND_5>
    <CORRECTION_GAIN_BAND_6>INTERNAL_CALIBRATION</CORRECTION_GAIN_BAND_6>
    <CORRECTION_GAIN_BAND_7>CPF</CORRECTION_GAIN_BAND_7>
    <CORRECTION_BIAS_BAND_1>CPF</CORRECTION_BIAS_BAND_1>
    <CORRECTION_BIAS_BAND_2>CPF</CORRECTION_BIAS_BAND_2>
    <CORRECTION_BIAS_BAND_3>CPF</CORRECTION_BIAS_BAND_3>
    <CORRECTION_BIAS_BAND_4>CPF</CORRECTION_BIAS_BAND_4>
    <CORRECTION_BIAS_BAND_5>CPF</CORRECTION_BIAS_BAND_5>
    <CORRECTION_BIAS_BAND_6>CPF</CORRECTION_BIAS_BAND_6>
    <CORRECTION_BIAS_BAND_7>CPF</CORRECTION_BIAS_BAND_7>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


mss_l1_landsat1_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9AF14YV</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LM01_L1TP_032030_19720729_20200909_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_4>LM01_L1TP_032030_19720729_20200909_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LM01_L1TP_032030_19720729_20200909_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LM01_L1TP_032030_19720729_20200909_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LM01_L1TP_032030_19720729_20200909_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_QUALITY_L1_PIXEL>LM01_L1TP_032030_19720729_20200909_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LM01_L1TP_032030_19720729_20200909_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LM01_L1TP_032030_19720729_20200909_02_T2_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_METADATA_ODL>LM01_L1TP_032030_19720729_20200909_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LM01_L1TP_032030_19720729_20200909_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_VERIFY_REPORT>LM01_L1TP_032030_19720729_20200909_02_T2_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LM01_L1TP_032030_19720729_20200909_02_T2_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_TYPE_BAND_4>UINT8</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT8</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6>UINT8</DATA_TYPE_BAND_6>
    <DATA_TYPE_BAND_7>UINT8</DATA_TYPE_BAND_7>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <PRESENT_BAND_4>Y</PRESENT_BAND_4>
    <PRESENT_BAND_5>Y</PRESENT_BAND_5>
    <PRESENT_BAND_6>Y</PRESENT_BAND_6>
    <PRESENT_BAND_7>Y</PRESENT_BAND_7>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_1</SPACECRAFT_ID>
    <SENSOR_ID>MSS</SENSOR_ID>
    <WRS_TYPE>1</WRS_TYPE>
    <WRS_PATH>032</WRS_PATH>
    <WRS_ROW>030</WRS_ROW>
    <DATE_ACQUIRED>1972-07-29</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>16:49:31.7330000Z</SCENE_CENTER_TIME>
    <STATION_ID>AAA</STATION_ID>
    <CLOUD_COVER>0.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>0.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>-1</IMAGE_QUALITY>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>N</SATURATION_BAND_6>
    <SATURATION_BAND_7>N</SATURATION_BAND_7>
    <SUN_AZIMUTH>128.00842031</SUN_AZIMUTH>
    <SUN_ELEVATION>56.29977419</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0152109</EARTH_SUN_DISTANCE>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>60.00</GRID_CELL_SIZE_REFLECTIVE>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>44.14255</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-99.72341</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>44.12425</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>-96.83145</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>42.15821</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-99.70038</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>42.14114</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>-96.90044</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>442140.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>4887960.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>673500.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>4887960.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>442140.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>4667580.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>673500.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>4667580.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9AF14YV</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>L2</REQUEST_ID>
    <LANDSAT_SCENE_ID>LM10320301972211AAA04</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LM01_L1TP_032030_19720729_20200909_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2020-09-09T16:01:31Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.3.1c</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_4>LM01_L1TP_032030_19720729_20200909_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LM01_L1TP_032030_19720729_20200909_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LM01_L1TP_032030_19720729_20200909_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LM01_L1TP_032030_19720729_20200909_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_QUALITY_L1_PIXEL>LM01_L1TP_032030_19720729_20200909_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LM01_L1TP_032030_19720729_20200909_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LM01_L1TP_032030_19720729_20200909_02_T2_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_METADATA_ODL>LM01_L1TP_032030_19720729_20200909_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LM01_L1TP_032030_19720729_20200909_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LM01CPF_19720723_19780107_02.01</FILE_NAME_CPF>
    <FILE_NAME_VERIFY_REPORT>LM01_L1TP_032030_19720729_20200909_02_T2_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LM01_L1TP_032030_19720729_20200909_02_T2_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>26</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>80.835</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>37.450</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>71.636</GEOMETRIC_RMSE_MODEL_X>
    <GROUND_CONTROL_POINTS_VERIFY>53</GROUND_CONTROL_POINTS_VERIFY>
    <GEOMETRIC_RMSE_VERIFY>0.944</GEOMETRIC_RMSE_VERIFY>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UL>0.770</GEOMETRIC_RMSE_VERIFY_QUAD_UL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UR>1.495</GEOMETRIC_RMSE_VERIFY_QUAD_UR>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LL>0.842</GEOMETRIC_RMSE_VERIFY_QUAD_LL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LR>1.049</GEOMETRIC_RMSE_VERIFY_QUAD_LR>
    <EPHEMERIS_TYPE>PREDICTIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_4>225.200</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-17.600</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>164.600</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-0.100</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>165.600</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>-0.100</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>154.600</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>0.000</RADIANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_4>0.407132</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.031818</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>0.346752</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.000211</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_6>0.420875</REFLECTANCE_MAXIMUM_BAND_6>
    <REFLECTANCE_MINIMUM_BAND_6>-0.000254</REFLECTANCE_MINIMUM_BAND_6>
    <REFLECTANCE_MAXIMUM_BAND_7>0.591490</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>0.000000</REFLECTANCE_MINIMUM_BAND_7>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>255</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>255</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>255</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_4>9.5591E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>6.4843E-01</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>6.5236E-01</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>6.0866E-01</RADIANCE_MULT_BAND_7>
    <RADIANCE_ADD_BAND_4>-18.55591</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-0.74843</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>-0.75236</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-0.60866</RADIANCE_ADD_BAND_7>
    <REFLECTANCE_MULT_BAND_4>1.7282E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>1.3660E-03</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_6>1.6580E-03</REFLECTANCE_MULT_BAND_6>
    <REFLECTANCE_MULT_BAND_7>2.3287E-03</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_ADD_BAND_4>-0.033547</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.001577</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_6>-0.001912</REFLECTANCE_ADD_BAND_6>
    <REFLECTANCE_ADD_BAND_7>-0.002329</REFLECTANCE_ADD_BAND_7>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>60.00</GRID_CELL_SIZE_REFLECTIVE>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <MAP_PROJECTION_L0RA>SOM</MAP_PROJECTION_L0RA>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <DATA_TYPE_L0RP>MSSX_L0RP</DATA_TYPE_L0RP>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <CORRECTION_GAIN_BAND_5>CPF</CORRECTION_GAIN_BAND_5>
    <CORRECTION_GAIN_BAND_6>CPF</CORRECTION_GAIN_BAND_6>
    <CORRECTION_GAIN_BAND_7>CPF</CORRECTION_GAIN_BAND_7>
    <GAIN_BAND_4>L</GAIN_BAND_4>
    <GAIN_BAND_5>L</GAIN_BAND_5>
    <GAIN_BAND_6>L</GAIN_BAND_6>
    <GAIN_BAND_7>L</GAIN_BAND_7>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


mss_l1_landsat4_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9AF14YV</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LM04_L1TP_029030_19840415_20200903_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LM04_L1TP_029030_19840415_20200903_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LM04_L1TP_029030_19840415_20200903_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LM04_L1TP_029030_19840415_20200903_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LM04_L1TP_029030_19840415_20200903_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_QUALITY_L1_PIXEL>LM04_L1TP_029030_19840415_20200903_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LM04_L1TP_029030_19840415_20200903_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LM04_L1TP_029030_19840415_20200903_02_T2_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_METADATA_ODL>LM04_L1TP_029030_19840415_20200903_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LM04_L1TP_029030_19840415_20200903_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_VERIFY_REPORT>LM04_L1TP_029030_19840415_20200903_02_T2_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LM04_L1TP_029030_19840415_20200903_02_T2_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_TYPE_BAND_1>UINT8</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT8</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT8</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT8</DATA_TYPE_BAND_4>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <PRESENT_BAND_1>Y</PRESENT_BAND_1>
    <PRESENT_BAND_2>Y</PRESENT_BAND_2>
    <PRESENT_BAND_3>Y</PRESENT_BAND_3>
    <PRESENT_BAND_4>Y</PRESENT_BAND_4>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_4</SPACECRAFT_ID>
    <SENSOR_ID>MSS</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>029</WRS_PATH>
    <WRS_ROW>030</WRS_ROW>
    <DATE_ACQUIRED>1984-04-15</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>16:38:15.9750000Z</SCENE_CENTER_TIME>
    <STATION_ID>AAA</STATION_ID>
    <CLOUD_COVER>2.00</CLOUD_COVER>
    <CLOUD_COVER_LAND>2.00</CLOUD_COVER_LAND>
    <IMAGE_QUALITY>5</IMAGE_QUALITY>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>N</SATURATION_BAND_2>
    <SATURATION_BAND_3>N</SATURATION_BAND_3>
    <SATURATION_BAND_4>Y</SATURATION_BAND_4>
    <SUN_AZIMUTH>135.96433420</SUN_AZIMUTH>
    <SUN_ELEVATION>49.08760662</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>1.0035512</EARTH_SUN_DISTANCE>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>60.00</GRID_CELL_SIZE_REFLECTIVE>
    <REFLECTIVE_LINES>100</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>100</REFLECTIVE_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>44.14698</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-98.49910</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>44.09661</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>-95.57170</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>42.27118</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-98.51422</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>42.22399</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>-95.67495</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>540060.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>4888320.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>774420.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>4888320.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>540060.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>4680000.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>774420.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>4680000.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P9AF14YV</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>L2</REQUEST_ID>
    <LANDSAT_SCENE_ID>LM40290301984106AAA03</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LM04_L1TP_029030_19840415_20200903_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1TP</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2020-09-03T04:50:06Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.3.1c</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LM04_L1TP_029030_19840415_20200903_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LM04_L1TP_029030_19840415_20200903_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LM04_L1TP_029030_19840415_20200903_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LM04_L1TP_029030_19840415_20200903_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_QUALITY_L1_PIXEL>LM04_L1TP_029030_19840415_20200903_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LM04_L1TP_029030_19840415_20200903_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_GROUND_CONTROL_POINT>LM04_L1TP_029030_19840415_20200903_02_T2_GCP.txt</FILE_NAME_GROUND_CONTROL_POINT>
    <FILE_NAME_METADATA_ODL>LM04_L1TP_029030_19840415_20200903_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LM04_L1TP_029030_19840415_20200903_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LM04CPF_19830401_19931231_02.01</FILE_NAME_CPF>
    <FILE_NAME_VERIFY_REPORT>LM04_L1TP_029030_19840415_20200903_02_T2_VER.txt</FILE_NAME_VERIFY_REPORT>
    <FILE_NAME_VERIFY_BROWSE>LM04_L1TP_029030_19840415_20200903_02_T2_VER.jpg</FILE_NAME_VERIFY_BROWSE>
    <DATA_SOURCE_ELEVATION>GLS2000</DATA_SOURCE_ELEVATION>
    <GROUND_CONTROL_POINTS_VERSION>5</GROUND_CONTROL_POINTS_VERSION>
    <GROUND_CONTROL_POINTS_MODEL>201</GROUND_CONTROL_POINTS_MODEL>
    <GEOMETRIC_RMSE_MODEL>19.942</GEOMETRIC_RMSE_MODEL>
    <GEOMETRIC_RMSE_MODEL_Y>14.470</GEOMETRIC_RMSE_MODEL_Y>
    <GEOMETRIC_RMSE_MODEL_X>13.722</GEOMETRIC_RMSE_MODEL_X>
    <GROUND_CONTROL_POINTS_VERIFY>348</GROUND_CONTROL_POINTS_VERIFY>
    <GEOMETRIC_RMSE_VERIFY>0.275</GEOMETRIC_RMSE_VERIFY>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UL>0.259</GEOMETRIC_RMSE_VERIFY_QUAD_UL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_UR>0.344</GEOMETRIC_RMSE_VERIFY_QUAD_UR>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LL>0.291</GEOMETRIC_RMSE_VERIFY_QUAD_LL>
    <GEOMETRIC_RMSE_VERIFY_QUAD_LR>0.302</GEOMETRIC_RMSE_VERIFY_QUAD_LR>
    <EPHEMERIS_TYPE>PREDICTIVE</EPHEMERIS_TYPE>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>226.100</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>3.800</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>161.200</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>3.700</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>144.600</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>5.100</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>125.300</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>4.300</RADIANCE_MINIMUM_BAND_4>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>0.405078</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>0.006808</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>0.334445</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>0.007676</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>0.370451</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>0.013066</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>0.472236</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>0.016206</REFLECTANCE_MINIMUM_BAND_4>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>255</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>255</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>255</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>255</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>8.7520E-01</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>6.2008E-01</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>5.4921E-01</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>4.7638E-01</RADIANCE_MULT_BAND_4>
    <RADIANCE_ADD_BAND_1>2.92480</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>3.07992</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>4.55079</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>3.82362</RADIANCE_ADD_BAND_4>
    <REFLECTANCE_MULT_BAND_1>1.5680E-03</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>1.2865E-03</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>1.4070E-03</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>1.7954E-03</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_ADD_BAND_1>0.005240</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>0.006390</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>0.011659</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>0.014411</REFLECTANCE_ADD_BAND_4>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>UTM</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <UTM_ZONE>14</UTM_ZONE>
    <GRID_CELL_SIZE_REFLECTIVE>60.00</GRID_CELL_SIZE_REFLECTIVE>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
    <MAP_PROJECTION_L0RA>SOM</MAP_PROJECTION_L0RA>
  </LEVEL1_PROJECTION_PARAMETERS>
  <PRODUCT_PARAMETERS>
    <DATA_TYPE_L0RP>MSSA_L0RP</DATA_TYPE_L0RP>
    <CORRECTION_GAIN_BAND_1>CPF</CORRECTION_GAIN_BAND_1>
    <CORRECTION_GAIN_BAND_2>CPF</CORRECTION_GAIN_BAND_2>
    <CORRECTION_GAIN_BAND_3>CPF</CORRECTION_GAIN_BAND_3>
    <CORRECTION_GAIN_BAND_4>CPF</CORRECTION_GAIN_BAND_4>
    <GAIN_BAND_1>L</GAIN_BAND_1>
    <GAIN_BAND_2>L</GAIN_BAND_2>
    <GAIN_BAND_3>L</GAIN_BAND_3>
    <GAIN_BAND_4>L</GAIN_BAND_4>
  </PRODUCT_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""

antarctic_metadata_text = b"""<?xml version="1.0" encoding="UTF-8"?>
<LANDSAT_METADATA_FILE>
  <PRODUCT_CONTENTS>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P975CC9B</DIGITAL_OBJECT_IDENTIFIER>
    <LANDSAT_PRODUCT_ID>LC08_L1GT_132122_20220301_20220308_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1GT</PROCESSING_LEVEL>
    <COLLECTION_NUMBER>02</COLLECTION_NUMBER>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <FILE_NAME_BAND_1>LC08_L1GT_132122_20220301_20220308_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC08_L1GT_132122_20220301_20220308_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC08_L1GT_132122_20220301_20220308_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC08_L1GT_132122_20220301_20220308_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC08_L1GT_132122_20220301_20220308_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC08_L1GT_132122_20220301_20220308_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LC08_L1GT_132122_20220301_20220308_02_T2_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_BAND_9>LC08_L1GT_132122_20220301_20220308_02_T2_B9.TIF</FILE_NAME_BAND_9>
    <FILE_NAME_BAND_10>LC08_L1GT_132122_20220301_20220308_02_T2_B10.TIF</FILE_NAME_BAND_10>
    <FILE_NAME_BAND_11>LC08_L1GT_132122_20220301_20220308_02_T2_B11.TIF</FILE_NAME_BAND_11>
    <FILE_NAME_QUALITY_L1_PIXEL>LC08_L1GT_132122_20220301_20220308_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC08_L1GT_132122_20220301_20220308_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC08_L1GT_132122_20220301_20220308_02_T2_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LC08_L1GT_132122_20220301_20220308_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC08_L1GT_132122_20220301_20220308_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <DATA_TYPE_BAND_1>UINT16</DATA_TYPE_BAND_1>
    <DATA_TYPE_BAND_2>UINT16</DATA_TYPE_BAND_2>
    <DATA_TYPE_BAND_3>UINT16</DATA_TYPE_BAND_3>
    <DATA_TYPE_BAND_4>UINT16</DATA_TYPE_BAND_4>
    <DATA_TYPE_BAND_5>UINT16</DATA_TYPE_BAND_5>
    <DATA_TYPE_BAND_6>UINT16</DATA_TYPE_BAND_6>
    <DATA_TYPE_BAND_7>UINT16</DATA_TYPE_BAND_7>
    <DATA_TYPE_BAND_8>UINT16</DATA_TYPE_BAND_8>
    <DATA_TYPE_BAND_9>UINT16</DATA_TYPE_BAND_9>
    <DATA_TYPE_BAND_10>UINT16</DATA_TYPE_BAND_10>
    <DATA_TYPE_BAND_11>UINT16</DATA_TYPE_BAND_11>
    <DATA_TYPE_QUALITY_L1_PIXEL>UINT16</DATA_TYPE_QUALITY_L1_PIXEL>
    <DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>UINT16</DATA_TYPE_QUALITY_L1_RADIOMETRIC_SATURATION>
    <DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SENSOR_ZENITH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>INT16</DATA_TYPE_ANGLE_SOLAR_ZENITH_BAND_4>
  </PRODUCT_CONTENTS>
  <IMAGE_ATTRIBUTES>
    <SPACECRAFT_ID>LANDSAT_8</SPACECRAFT_ID>
    <SENSOR_ID>OLI_TIRS</SENSOR_ID>
    <WRS_TYPE>2</WRS_TYPE>
    <WRS_PATH>132</WRS_PATH>
    <WRS_ROW>122</WRS_ROW>
    <NADIR_OFFNADIR>OFFNADIR</NADIR_OFFNADIR>
    <TARGET_WRS_PATH>132</TARGET_WRS_PATH>
    <TARGET_WRS_ROW>992</TARGET_WRS_ROW>
    <DATE_ACQUIRED>2022-03-01</DATE_ACQUIRED>
    <SCENE_CENTER_TIME>04:25:04.3013780Z</SCENE_CENTER_TIME>
    <STATION_ID>LGN</STATION_ID>
    <CLOUD_COVER>8.30</CLOUD_COVER>
    <CLOUD_COVER_LAND>8.30</CLOUD_COVER_LAND>
    <IMAGE_QUALITY_OLI>9</IMAGE_QUALITY_OLI>
    <IMAGE_QUALITY_TIRS>9</IMAGE_QUALITY_TIRS>
    <SATURATION_BAND_1>N</SATURATION_BAND_1>
    <SATURATION_BAND_2>N</SATURATION_BAND_2>
    <SATURATION_BAND_3>N</SATURATION_BAND_3>
    <SATURATION_BAND_4>N</SATURATION_BAND_4>
    <SATURATION_BAND_5>N</SATURATION_BAND_5>
    <SATURATION_BAND_6>N</SATURATION_BAND_6>
    <SATURATION_BAND_7>N</SATURATION_BAND_7>
    <SATURATION_BAND_8>N</SATURATION_BAND_8>
    <SATURATION_BAND_9>N</SATURATION_BAND_9>
    <ROLL_ANGLE>14.106</ROLL_ANGLE>
    <SUN_AZIMUTH>120.47945877</SUN_AZIMUTH>
    <SUN_ELEVATION>4.34563947</SUN_ELEVATION>
    <EARTH_SUN_DISTANCE>0.9907629</EARTH_SUN_DISTANCE>
    <TRUNCATION_OLI>UPPER</TRUNCATION_OLI>
    <TIRS_SSM_MODEL>FINAL</TIRS_SSM_MODEL>
    <TIRS_SSM_POSITION_STATUS>ESTIMATED</TIRS_SSM_POSITION_STATUS>
  </IMAGE_ATTRIBUTES>
  <PROJECTION_ATTRIBUTES>
    <MAP_PROJECTION>PS</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <VERTICAL_LON_FROM_POLE>0.00000</VERTICAL_LON_FROM_POLE>
    <TRUE_SCALE_LAT>-71.00000</TRUE_SCALE_LAT>
    <FALSE_EASTING>0</FALSE_EASTING>
    <FALSE_NORTHING>0</FALSE_NORTHING>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <PANCHROMATIC_LINES>14561</PANCHROMATIC_LINES>
    <PANCHROMATIC_SAMPLES>13301</PANCHROMATIC_SAMPLES>
    <REFLECTIVE_LINES>7281</REFLECTIVE_LINES>
    <REFLECTIVE_SAMPLES>6651</REFLECTIVE_SAMPLES>
    <THERMAL_LINES>7281</THERMAL_LINES>
    <THERMAL_SAMPLES>6651</THERMAL_SAMPLES>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <CORNER_UL_LAT_PRODUCT>-82.45851</CORNER_UL_LAT_PRODUCT>
    <CORNER_UL_LON_PRODUCT>-9.70339</CORNER_UL_LON_PRODUCT>
    <CORNER_UR_LAT_PRODUCT>-82.54491</CORNER_UR_LAT_PRODUCT>
    <CORNER_UR_LON_PRODUCT>4.32719</CORNER_UR_LON_PRODUCT>
    <CORNER_LL_LAT_PRODUCT>-84.42330</CORNER_LL_LAT_PRODUCT>
    <CORNER_LL_LON_PRODUCT>-13.18371</CORNER_LL_LON_PRODUCT>
    <CORNER_LR_LAT_PRODUCT>-84.54101</CORNER_LR_LAT_PRODUCT>
    <CORNER_LR_LON_PRODUCT>5.91806</CORNER_LR_LON_PRODUCT>
    <CORNER_UL_PROJECTION_X_PRODUCT>-138300.000</CORNER_UL_PROJECTION_X_PRODUCT>
    <CORNER_UL_PROJECTION_Y_PRODUCT>808800.000</CORNER_UL_PROJECTION_Y_PRODUCT>
    <CORNER_UR_PROJECTION_X_PRODUCT>61200.000</CORNER_UR_PROJECTION_X_PRODUCT>
    <CORNER_UR_PROJECTION_Y_PRODUCT>808800.000</CORNER_UR_PROJECTION_Y_PRODUCT>
    <CORNER_LL_PROJECTION_X_PRODUCT>-138300.000</CORNER_LL_PROJECTION_X_PRODUCT>
    <CORNER_LL_PROJECTION_Y_PRODUCT>590400.000</CORNER_LL_PROJECTION_Y_PRODUCT>
    <CORNER_LR_PROJECTION_X_PRODUCT>61200.000</CORNER_LR_PROJECTION_X_PRODUCT>
    <CORNER_LR_PROJECTION_Y_PRODUCT>590400.000</CORNER_LR_PROJECTION_Y_PRODUCT>
  </PROJECTION_ATTRIBUTES>
  <LEVEL1_PROCESSING_RECORD>
    <ORIGIN>Image courtesy of the U.S. Geological Survey</ORIGIN>
    <DIGITAL_OBJECT_IDENTIFIER>https://doi.org/10.5066/P975CC9B</DIGITAL_OBJECT_IDENTIFIER>
    <REQUEST_ID>P701aw6qw352j_00004</REQUEST_ID>
    <LANDSAT_SCENE_ID>LC81321222022060LGN00</LANDSAT_SCENE_ID>
    <LANDSAT_PRODUCT_ID>LC08_L1GT_132122_20220301_20220308_02_T2</LANDSAT_PRODUCT_ID>
    <PROCESSING_LEVEL>L1GT</PROCESSING_LEVEL>
    <COLLECTION_CATEGORY>T2</COLLECTION_CATEGORY>
    <OUTPUT_FORMAT>GEOTIFF</OUTPUT_FORMAT>
    <DATE_PRODUCT_GENERATED>2022-03-08T22:11:40Z</DATE_PRODUCT_GENERATED>
    <PROCESSING_SOFTWARE_VERSION>LPGS_15.6.0</PROCESSING_SOFTWARE_VERSION>
    <FILE_NAME_BAND_1>LC08_L1GT_132122_20220301_20220308_02_T2_B1.TIF</FILE_NAME_BAND_1>
    <FILE_NAME_BAND_2>LC08_L1GT_132122_20220301_20220308_02_T2_B2.TIF</FILE_NAME_BAND_2>
    <FILE_NAME_BAND_3>LC08_L1GT_132122_20220301_20220308_02_T2_B3.TIF</FILE_NAME_BAND_3>
    <FILE_NAME_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_B4.TIF</FILE_NAME_BAND_4>
    <FILE_NAME_BAND_5>LC08_L1GT_132122_20220301_20220308_02_T2_B5.TIF</FILE_NAME_BAND_5>
    <FILE_NAME_BAND_6>LC08_L1GT_132122_20220301_20220308_02_T2_B6.TIF</FILE_NAME_BAND_6>
    <FILE_NAME_BAND_7>LC08_L1GT_132122_20220301_20220308_02_T2_B7.TIF</FILE_NAME_BAND_7>
    <FILE_NAME_BAND_8>LC08_L1GT_132122_20220301_20220308_02_T2_B8.TIF</FILE_NAME_BAND_8>
    <FILE_NAME_BAND_9>LC08_L1GT_132122_20220301_20220308_02_T2_B9.TIF</FILE_NAME_BAND_9>
    <FILE_NAME_BAND_10>LC08_L1GT_132122_20220301_20220308_02_T2_B10.TIF</FILE_NAME_BAND_10>
    <FILE_NAME_BAND_11>LC08_L1GT_132122_20220301_20220308_02_T2_B11.TIF</FILE_NAME_BAND_11>
    <FILE_NAME_QUALITY_L1_PIXEL>LC08_L1GT_132122_20220301_20220308_02_T2_QA_PIXEL.TIF</FILE_NAME_QUALITY_L1_PIXEL>
    <FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>LC08_L1GT_132122_20220301_20220308_02_T2_QA_RADSAT.TIF</FILE_NAME_QUALITY_L1_RADIOMETRIC_SATURATION>
    <FILE_NAME_ANGLE_COEFFICIENT>LC08_L1GT_132122_20220301_20220308_02_T2_ANG.txt</FILE_NAME_ANGLE_COEFFICIENT>
    <FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_VAA.TIF</FILE_NAME_ANGLE_SENSOR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_VZA.TIF</FILE_NAME_ANGLE_SENSOR_ZENITH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_SAA.TIF</FILE_NAME_ANGLE_SOLAR_AZIMUTH_BAND_4>
    <FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>LC08_L1GT_132122_20220301_20220308_02_T2_SZA.TIF</FILE_NAME_ANGLE_SOLAR_ZENITH_BAND_4>
    <FILE_NAME_METADATA_ODL>LC08_L1GT_132122_20220301_20220308_02_T2_MTL.txt</FILE_NAME_METADATA_ODL>
    <FILE_NAME_METADATA_XML>LC08_L1GT_132122_20220301_20220308_02_T2_MTL.xml</FILE_NAME_METADATA_XML>
    <FILE_NAME_CPF>LC08CPF_20220301_20220331_02.03</FILE_NAME_CPF>
    <FILE_NAME_BPF_OLI>LO8BPF20220301033834_20220301051616.01</FILE_NAME_BPF_OLI>
    <FILE_NAME_BPF_TIRS>LT8BPF20220225134316_20220303110033.01</FILE_NAME_BPF_TIRS>
    <FILE_NAME_RLUT>LC08RLUT_20150303_20431231_02_01.h5</FILE_NAME_RLUT>
    <DATA_SOURCE_TIRS_STRAY_LIGHT_CORRECTION>TIRS</DATA_SOURCE_TIRS_STRAY_LIGHT_CORRECTION>
    <DATA_SOURCE_ELEVATION>RAMP</DATA_SOURCE_ELEVATION>
  </LEVEL1_PROCESSING_RECORD>
  <LEVEL1_MIN_MAX_RADIANCE>
    <RADIANCE_MAXIMUM_BAND_1>774.30127</RADIANCE_MAXIMUM_BAND_1>
    <RADIANCE_MINIMUM_BAND_1>-63.94205</RADIANCE_MINIMUM_BAND_1>
    <RADIANCE_MAXIMUM_BAND_2>792.89392</RADIANCE_MAXIMUM_BAND_2>
    <RADIANCE_MINIMUM_BAND_2>-65.47744</RADIANCE_MINIMUM_BAND_2>
    <RADIANCE_MAXIMUM_BAND_3>730.64496</RADIANCE_MAXIMUM_BAND_3>
    <RADIANCE_MINIMUM_BAND_3>-60.33690</RADIANCE_MINIMUM_BAND_3>
    <RADIANCE_MAXIMUM_BAND_4>616.12097</RADIANCE_MAXIMUM_BAND_4>
    <RADIANCE_MINIMUM_BAND_4>-50.87947</RADIANCE_MINIMUM_BAND_4>
    <RADIANCE_MAXIMUM_BAND_5>377.03534</RADIANCE_MAXIMUM_BAND_5>
    <RADIANCE_MINIMUM_BAND_5>-31.13570</RADIANCE_MINIMUM_BAND_5>
    <RADIANCE_MAXIMUM_BAND_6>93.76526</RADIANCE_MAXIMUM_BAND_6>
    <RADIANCE_MINIMUM_BAND_6>-7.74317</RADIANCE_MINIMUM_BAND_6>
    <RADIANCE_MAXIMUM_BAND_7>31.60391</RADIANCE_MAXIMUM_BAND_7>
    <RADIANCE_MINIMUM_BAND_7>-2.60986</RADIANCE_MINIMUM_BAND_7>
    <RADIANCE_MAXIMUM_BAND_8>697.27942</RADIANCE_MAXIMUM_BAND_8>
    <RADIANCE_MINIMUM_BAND_8>-57.58156</RADIANCE_MINIMUM_BAND_8>
    <RADIANCE_MAXIMUM_BAND_9>147.35396</RADIANCE_MAXIMUM_BAND_9>
    <RADIANCE_MINIMUM_BAND_9>-12.16854</RADIANCE_MINIMUM_BAND_9>
    <RADIANCE_MAXIMUM_BAND_10>22.00180</RADIANCE_MAXIMUM_BAND_10>
    <RADIANCE_MINIMUM_BAND_10>0.10033</RADIANCE_MINIMUM_BAND_10>
    <RADIANCE_MAXIMUM_BAND_11>22.00180</RADIANCE_MAXIMUM_BAND_11>
    <RADIANCE_MINIMUM_BAND_11>0.10033</RADIANCE_MINIMUM_BAND_11>
  </LEVEL1_MIN_MAX_RADIANCE>
  <LEVEL1_MIN_MAX_REFLECTANCE>
    <REFLECTANCE_MAXIMUM_BAND_1>1.210700</REFLECTANCE_MAXIMUM_BAND_1>
    <REFLECTANCE_MINIMUM_BAND_1>-0.099980</REFLECTANCE_MINIMUM_BAND_1>
    <REFLECTANCE_MAXIMUM_BAND_2>1.210700</REFLECTANCE_MAXIMUM_BAND_2>
    <REFLECTANCE_MINIMUM_BAND_2>-0.099980</REFLECTANCE_MINIMUM_BAND_2>
    <REFLECTANCE_MAXIMUM_BAND_3>1.210700</REFLECTANCE_MAXIMUM_BAND_3>
    <REFLECTANCE_MINIMUM_BAND_3>-0.099980</REFLECTANCE_MINIMUM_BAND_3>
    <REFLECTANCE_MAXIMUM_BAND_4>1.210700</REFLECTANCE_MAXIMUM_BAND_4>
    <REFLECTANCE_MINIMUM_BAND_4>-0.099980</REFLECTANCE_MINIMUM_BAND_4>
    <REFLECTANCE_MAXIMUM_BAND_5>1.210700</REFLECTANCE_MAXIMUM_BAND_5>
    <REFLECTANCE_MINIMUM_BAND_5>-0.099980</REFLECTANCE_MINIMUM_BAND_5>
    <REFLECTANCE_MAXIMUM_BAND_6>1.210700</REFLECTANCE_MAXIMUM_BAND_6>
    <REFLECTANCE_MINIMUM_BAND_6>-0.099980</REFLECTANCE_MINIMUM_BAND_6>
    <REFLECTANCE_MAXIMUM_BAND_7>1.210700</REFLECTANCE_MAXIMUM_BAND_7>
    <REFLECTANCE_MINIMUM_BAND_7>-0.099980</REFLECTANCE_MINIMUM_BAND_7>
    <REFLECTANCE_MAXIMUM_BAND_8>1.210700</REFLECTANCE_MAXIMUM_BAND_8>
    <REFLECTANCE_MINIMUM_BAND_8>-0.099980</REFLECTANCE_MINIMUM_BAND_8>
    <REFLECTANCE_MAXIMUM_BAND_9>1.210700</REFLECTANCE_MAXIMUM_BAND_9>
    <REFLECTANCE_MINIMUM_BAND_9>-0.099980</REFLECTANCE_MINIMUM_BAND_9>
  </LEVEL1_MIN_MAX_REFLECTANCE>
  <LEVEL1_MIN_MAX_PIXEL_VALUE>
    <QUANTIZE_CAL_MAX_BAND_1>65535</QUANTIZE_CAL_MAX_BAND_1>
    <QUANTIZE_CAL_MIN_BAND_1>1</QUANTIZE_CAL_MIN_BAND_1>
    <QUANTIZE_CAL_MAX_BAND_2>65535</QUANTIZE_CAL_MAX_BAND_2>
    <QUANTIZE_CAL_MIN_BAND_2>1</QUANTIZE_CAL_MIN_BAND_2>
    <QUANTIZE_CAL_MAX_BAND_3>65535</QUANTIZE_CAL_MAX_BAND_3>
    <QUANTIZE_CAL_MIN_BAND_3>1</QUANTIZE_CAL_MIN_BAND_3>
    <QUANTIZE_CAL_MAX_BAND_4>65535</QUANTIZE_CAL_MAX_BAND_4>
    <QUANTIZE_CAL_MIN_BAND_4>1</QUANTIZE_CAL_MIN_BAND_4>
    <QUANTIZE_CAL_MAX_BAND_5>65535</QUANTIZE_CAL_MAX_BAND_5>
    <QUANTIZE_CAL_MIN_BAND_5>1</QUANTIZE_CAL_MIN_BAND_5>
    <QUANTIZE_CAL_MAX_BAND_6>65535</QUANTIZE_CAL_MAX_BAND_6>
    <QUANTIZE_CAL_MIN_BAND_6>1</QUANTIZE_CAL_MIN_BAND_6>
    <QUANTIZE_CAL_MAX_BAND_7>65535</QUANTIZE_CAL_MAX_BAND_7>
    <QUANTIZE_CAL_MIN_BAND_7>1</QUANTIZE_CAL_MIN_BAND_7>
    <QUANTIZE_CAL_MAX_BAND_8>65535</QUANTIZE_CAL_MAX_BAND_8>
    <QUANTIZE_CAL_MIN_BAND_8>1</QUANTIZE_CAL_MIN_BAND_8>
    <QUANTIZE_CAL_MAX_BAND_9>65535</QUANTIZE_CAL_MAX_BAND_9>
    <QUANTIZE_CAL_MIN_BAND_9>1</QUANTIZE_CAL_MIN_BAND_9>
    <QUANTIZE_CAL_MAX_BAND_10>65535</QUANTIZE_CAL_MAX_BAND_10>
    <QUANTIZE_CAL_MIN_BAND_10>1</QUANTIZE_CAL_MIN_BAND_10>
    <QUANTIZE_CAL_MAX_BAND_11>65535</QUANTIZE_CAL_MAX_BAND_11>
    <QUANTIZE_CAL_MIN_BAND_11>1</QUANTIZE_CAL_MIN_BAND_11>
  </LEVEL1_MIN_MAX_PIXEL_VALUE>
  <LEVEL1_RADIOMETRIC_RESCALING>
    <RADIANCE_MULT_BAND_1>1.2791E-02</RADIANCE_MULT_BAND_1>
    <RADIANCE_MULT_BAND_2>1.3098E-02</RADIANCE_MULT_BAND_2>
    <RADIANCE_MULT_BAND_3>1.2070E-02</RADIANCE_MULT_BAND_3>
    <RADIANCE_MULT_BAND_4>1.0178E-02</RADIANCE_MULT_BAND_4>
    <RADIANCE_MULT_BAND_5>6.2284E-03</RADIANCE_MULT_BAND_5>
    <RADIANCE_MULT_BAND_6>1.5489E-03</RADIANCE_MULT_BAND_6>
    <RADIANCE_MULT_BAND_7>5.2208E-04</RADIANCE_MULT_BAND_7>
    <RADIANCE_MULT_BAND_8>1.1519E-02</RADIANCE_MULT_BAND_8>
    <RADIANCE_MULT_BAND_9>2.4342E-03</RADIANCE_MULT_BAND_9>
    <RADIANCE_MULT_BAND_10>3.3420E-04</RADIANCE_MULT_BAND_10>
    <RADIANCE_MULT_BAND_11>3.3420E-04</RADIANCE_MULT_BAND_11>
    <RADIANCE_ADD_BAND_1>-63.95484</RADIANCE_ADD_BAND_1>
    <RADIANCE_ADD_BAND_2>-65.49054</RADIANCE_ADD_BAND_2>
    <RADIANCE_ADD_BAND_3>-60.34897</RADIANCE_ADD_BAND_3>
    <RADIANCE_ADD_BAND_4>-50.88965</RADIANCE_ADD_BAND_4>
    <RADIANCE_ADD_BAND_5>-31.14193</RADIANCE_ADD_BAND_5>
    <RADIANCE_ADD_BAND_6>-7.74471</RADIANCE_ADD_BAND_6>
    <RADIANCE_ADD_BAND_7>-2.61038</RADIANCE_ADD_BAND_7>
    <RADIANCE_ADD_BAND_8>-57.59308</RADIANCE_ADD_BAND_8>
    <RADIANCE_ADD_BAND_9>-12.17097</RADIANCE_ADD_BAND_9>
    <RADIANCE_ADD_BAND_10>0.10000</RADIANCE_ADD_BAND_10>
    <RADIANCE_ADD_BAND_11>0.10000</RADIANCE_ADD_BAND_11>
    <REFLECTANCE_MULT_BAND_1>2.0000E-05</REFLECTANCE_MULT_BAND_1>
    <REFLECTANCE_MULT_BAND_2>2.0000E-05</REFLECTANCE_MULT_BAND_2>
    <REFLECTANCE_MULT_BAND_3>2.0000E-05</REFLECTANCE_MULT_BAND_3>
    <REFLECTANCE_MULT_BAND_4>2.0000E-05</REFLECTANCE_MULT_BAND_4>
    <REFLECTANCE_MULT_BAND_5>2.0000E-05</REFLECTANCE_MULT_BAND_5>
    <REFLECTANCE_MULT_BAND_6>2.0000E-05</REFLECTANCE_MULT_BAND_6>
    <REFLECTANCE_MULT_BAND_7>2.0000E-05</REFLECTANCE_MULT_BAND_7>
    <REFLECTANCE_MULT_BAND_8>2.0000E-05</REFLECTANCE_MULT_BAND_8>
    <REFLECTANCE_MULT_BAND_9>2.0000E-05</REFLECTANCE_MULT_BAND_9>
    <REFLECTANCE_ADD_BAND_1>-0.100000</REFLECTANCE_ADD_BAND_1>
    <REFLECTANCE_ADD_BAND_2>-0.100000</REFLECTANCE_ADD_BAND_2>
    <REFLECTANCE_ADD_BAND_3>-0.100000</REFLECTANCE_ADD_BAND_3>
    <REFLECTANCE_ADD_BAND_4>-0.100000</REFLECTANCE_ADD_BAND_4>
    <REFLECTANCE_ADD_BAND_5>-0.100000</REFLECTANCE_ADD_BAND_5>
    <REFLECTANCE_ADD_BAND_6>-0.100000</REFLECTANCE_ADD_BAND_6>
    <REFLECTANCE_ADD_BAND_7>-0.100000</REFLECTANCE_ADD_BAND_7>
    <REFLECTANCE_ADD_BAND_8>-0.100000</REFLECTANCE_ADD_BAND_8>
    <REFLECTANCE_ADD_BAND_9>-0.100000</REFLECTANCE_ADD_BAND_9>
  </LEVEL1_RADIOMETRIC_RESCALING>
  <LEVEL1_THERMAL_CONSTANTS>
    <K1_CONSTANT_BAND_10>774.8853</K1_CONSTANT_BAND_10>
    <K2_CONSTANT_BAND_10>1321.0789</K2_CONSTANT_BAND_10>
    <K1_CONSTANT_BAND_11>480.8883</K1_CONSTANT_BAND_11>
    <K2_CONSTANT_BAND_11>1201.1442</K2_CONSTANT_BAND_11>
  </LEVEL1_THERMAL_CONSTANTS>
  <LEVEL1_PROJECTION_PARAMETERS>
    <MAP_PROJECTION>PS</MAP_PROJECTION>
    <DATUM>WGS84</DATUM>
    <ELLIPSOID>WGS84</ELLIPSOID>
    <VERTICAL_LON_FROM_POLE>0.00000</VERTICAL_LON_FROM_POLE>
    <TRUE_SCALE_LAT>-71.00000</TRUE_SCALE_LAT>
    <FALSE_EASTING>0</FALSE_EASTING>
    <FALSE_NORTHING>0</FALSE_NORTHING>
    <GRID_CELL_SIZE_PANCHROMATIC>15.00</GRID_CELL_SIZE_PANCHROMATIC>
    <GRID_CELL_SIZE_REFLECTIVE>30.00</GRID_CELL_SIZE_REFLECTIVE>
    <GRID_CELL_SIZE_THERMAL>30.00</GRID_CELL_SIZE_THERMAL>
    <ORIENTATION>NORTH_UP</ORIENTATION>
    <RESAMPLING_OPTION>CUBIC_CONVOLUTION</RESAMPLING_OPTION>
  </LEVEL1_PROJECTION_PARAMETERS>
</LANDSAT_METADATA_FILE>
"""


x_size = 100
y_size = 100

oli_tirs_l1_date = datetime(2024, 5, 12, tzinfo=timezone.utc)
oli_tirs_l2_date = datetime(2024, 6, 16, tzinfo=timezone.utc)
etm_l1_date = datetime(2023, 12, 8, tzinfo=timezone.utc)
etm_l2_date = datetime(2023, 8, 17, tzinfo=timezone.utc)
tm_l1_date = datetime(1989, 8, 18, tzinfo=timezone.utc)
tm_l2_date = datetime(2011, 8, 17, tzinfo=timezone.utc)
mss_l1_landsat1_date = datetime(1972, 7, 29, tzinfo=timezone.utc)
mss_l1_landsat4_date = datetime(1984, 4, 15, tzinfo=timezone.utc)

oli_tirs_l1_datetime = datetime(2024, 5, 2, 18, 0, 24, tzinfo=timezone.utc)
oli_tirs_l2_datetime = datetime(2024, 6, 16, 17, 10, 58, tzinfo=timezone.utc)
etm_l1_datetime = datetime(2023, 12, 8, 11, 44, 51, tzinfo=timezone.utc)
etm_l2_datetime = datetime(2023, 8, 17, 14, 54, 20, tzinfo=timezone.utc)
tm_l1_datetime = datetime(1989, 8, 18, 4, 26, 11, tzinfo=timezone.utc)
tm_l2_datetime = datetime(2011, 8, 17, 7, 10, 40, tzinfo=timezone.utc)
mss_l1_landsat1_datetime = datetime(1972, 7, 29, 16, 49, 31, tzinfo=timezone.utc)
mss_l1_landsat4_datetime = datetime(1984, 4, 15, 16, 38, 15, tzinfo=timezone.utc)

oli_tirs_l1_extent = (619485.0, 2440485.0, 850515.0, 2675715.0)
oli_tirs_l2_extent = (534885.0, 4665585.0, 765015.0, 4899315.0)
etm_l1_extent = (240885.0, -3301215.0, 483015.0, -3091485.0)
etm_l2_extent = (85785.0, 4680885.0, 336915.0, 4904115.0)
tm_l1_extent = (322185.0, 6085185.0, 567615.0, 6311415.0)
tm_l2_extent = (258285.0, 855285.0, 495315.0, 1064415.0)
mss_l1_landsat1_extent = (442110.0, 4667550.0, 673530.0, 4887990.0)
mss_l1_landsat4_extent = (540030.0, 4679970.0, 774450.0, 4888350.0)
antarctic_extent = (-138315.0, 590385.0, 61215.0, 808815.0)

oli_tirs_l1_pan_extent = (619492.5, 2440492.5, 850507.5, 2675707.5)
etm_l1_pan_extent = (240892.5, -3301207.5, 483007.5, -3091492.5)
antarctic_pan_extent = (-138307.5, 590392.5, 61207.5, 808807.5)

oli_tirs_l1_cal_dict = {"B1": (0.012357, -61.78647, 2e-05, -0.1),
                        "B5": (0.0060172, -30.08607, 2e-05, -0.1),
                        "B10": (0.0003342, 0.1, 774.8853, 1321.0789)}
oli_tirs_l2_cal_dict = {"B1": (2.75e-05, -0.2),
                        "B5": (2.75e-05, -0.2),
                        "B10": (0.00341802, 149.0)}
etm_l1_cal_dict = {"B1": (7.7874e-01, -6.97874, 1.1661e-03, -0.010450),
                   "B5": (1.2622e-01, -1.12622, 1.7365e-03, -0.015494),
                   "B6_VCID_2": (3.7205e-02, 3.16280, 666.09, 1282.71)}
etm_l2_cal_dict = {"B1": (2.75e-05, -0.2),
                   "B5": (2.75e-05, -0.2),
                   "B6": (0.00341802, 149.0)}
tm_l1_cal_dict = {"B1": (6.7921e-01, -2.19921, 1.1252e-03, -0.003643),
                  "B5": (1.2508e-01, -0.49508, 1.8160e-03, -0.007188),
                  "B6": (5.5375e-02, 1.18243, 671.62, 1284.30)}
tm_l2_cal_dict = {"B1": (2.75e-05, -0.2),
                  "B5": (2.75e-05, -0.2),
                  "B6": (0.00341802, 149.0)}
mss_l1_landsat1_cal_dict = {"B5": (6.4843e-01, -0.74843, 1.3660e-03, -0.001577),
                            "B6": (6.5236e-01, -0.75236, 1.6580e-03, -0.001912),
                            "B7": (6.0866e-01, -0.60866, 2.3287e-03, -0.002329)}
mss_l1_landsat4_cal_dict = {"B1": (8.7520e-01, 2.92480, 1.5680e-03, 0.005240),
                            "B2": (6.2008e-01, 3.07992, 1.2865e-03, 0.006390),
                            "B3": (5.4921e-01, 4.55079, 1.4070e-03, 0.011659)}

oli_tirs_l1_sp_params = [0.0098329, -49.16426, 2e-05, -0.1]
oli_tirs_l1_th_params = [0.0003342, 0.100000, 480.8883, 1201.1442]
oli_tirs_l2_sp_params = [2.75e-05, -0.2]
oli_tirs_l2_th_params = [0.00341802, 149.0]
etm_l1_sp_params = [9.6929e-01, -6.06929, 2.7591e-03, -0.017277]
etm_l1_th_params = [6.7087e-02, -0.06709, 666.09, 1282.71]
etm_l2_sp_params = [2.75e-05, -0.2]
etm_l2_th_params = [0.00341802, 149.0]
tm_l1_sp_params = [8.7602e-01, -2.38602, 2.7296e-03, -0.007435]
tm_l1_th_params = [5.5375e-02, 1.18243, 671.62, 1284.30]
tm_l2_sp_params = [2.75e-05, -0.2]
tm_l2_th_params = [0.00341802, 149.0]
mss_l1_landsat1_sp_params = [9.5591e-01, -18.55591, 1.7282e-03, -0.033547]
mss_l1_landsat4_sp_params = [4.7638e-01, 3.82362, 1.7954e-03, 0.014411]


@pytest.fixture(scope="session")
def spectral_data():
    """Get the data for the generic spectral channel."""
    return da.random.randint(12000, 16000,
                             size=(y_size, x_size),
                             chunks=(50, 50)).astype(np.uint16)


@pytest.fixture(scope="session")
def thermal_data():
    """Get the data for the generic thermal channel."""
    return da.random.randint(8000, 14000,
                             size=(y_size, x_size),
                             chunks=(50, 50)).astype(np.uint16)


@pytest.fixture(scope="session")
def sza_rad_data():
    """Get the data for the sza or radiance channel."""
    return da.random.randint(1, 10000,
                             size=(y_size, x_size),
                             chunks=(50, 50)).astype(np.uint16)


def create_tif_file(data, name, area, filename, date):
    """Create a tif file."""
    data_array = xr.DataArray(data,
                              dims=("y", "x"),
                              attrs={"name": name,
                                     "start_time": date})
    scn = Scene()
    scn["band_data"] = data_array
    scn["band_data"].attrs["area"] = area
    scn.save_dataset("band_data", writer="geotiff", enhance=False, fill_value=0,
                     filename=os.fspath(filename))


def get_area_fixture(name, zone, extent):
    """Get area def."""
    @pytest.fixture(scope="session")
    def _fixture():
        """Fixture body."""
        pcs_id = "WGS84 / UTM zone {zone}N"
        proj4_dict = {"proj": "utm", "zone": zone, "datum": "WGS84", "units": "m", "no_defs": None, "type": "crs"}
        area_extent = extent
        _fixture.__name__ = f"{name}_area"
        return AreaDefinition("geotiff_area", pcs_id, pcs_id, proj4_dict, x_size, y_size, area_extent)
    _fixture.__name__ = f"{name}_area"
    return _fixture


def make_temp_path_fixture(name):
    """Create a temp directory for a Landsat product."""
    @pytest.fixture(scope="session")
    def _fixture(tmp_path_factory):
        return tmp_path_factory.mktemp(f"{name}_files")
    _fixture.__name__ = f"{name}_files_path"
    return _fixture


def convert_to_fsfile(files):
    """Turn pathes to FSFile objects."""
    from fsspec.implementations.local import LocalFileSystem

    from satpy.readers.core.remote import FSFile

    fs = LocalFileSystem()
    files = (
        FSFile(os.path.abspath(file), fs=fs)
        for file in files
    )
    return files


oli_tirs_l1_area = get_area_fixture("oli_tirs_l1", 40, oli_tirs_l1_extent)
oli_tirs_l2_area = get_area_fixture("oli_tirs_l2", 14, oli_tirs_l2_extent)
etm_l1_area = get_area_fixture("etm_l1", 20, etm_l1_extent)
etm_l2_area = get_area_fixture("etm_l2", 15, etm_l2_extent)
tm_l1_area = get_area_fixture("tm_l1", 46, tm_l1_extent)
tm_l2_area = get_area_fixture("tm_l2", 38, tm_l2_extent)
mss_l1_landsat1_area = get_area_fixture("mss_l1_landsat1", 14, mss_l1_landsat1_extent)
mss_l1_landsat4_area = get_area_fixture("mss_l1_landsat4", 14, mss_l1_landsat4_extent)

oli_tirs_l1_files_path = make_temp_path_fixture("oli_tirs_l1")
oli_tirs_l2_files_path = make_temp_path_fixture("oli_tirs_l2")
etm_l1_files_path = make_temp_path_fixture("etm_l1")
etm_l2_files_path = make_temp_path_fixture("etm_l2")
tm_l1_files_path = make_temp_path_fixture("tm_l1")
tm_l2_files_path = make_temp_path_fixture("tm_l2")
mss_l1_landsat1_files_path = make_temp_path_fixture("mss_l1_landsat1")
mss_l1_landsat4_files_path = make_temp_path_fixture("mss_l1_landsat4")
antarctic_files_path = make_temp_path_fixture("antarctic")


@pytest.fixture(scope="session")
def oli_tirs_l1_b4_file(oli_tirs_l1_files_path, spectral_data, oli_tirs_l1_area):
    """Create the file for the Landsat OLI TIRS L1 B4 channel."""
    filename = oli_tirs_l1_files_path / "LC08_L1TP_026200_20240502_20240513_02_T2_B4.TIF"
    create_tif_file(spectral_data, "B4", oli_tirs_l1_area, filename, oli_tirs_l1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l1_b11_file(oli_tirs_l1_files_path, thermal_data, oli_tirs_l1_area):
    """Create the file for the Landsat OLI TIRS L1 B11 channel."""
    filename = oli_tirs_l1_files_path / "LC08_L1TP_026200_20240502_20240513_02_T2_B11.TIF"
    create_tif_file(thermal_data, "B11", oli_tirs_l1_area, filename, oli_tirs_l1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l1_sza_file(oli_tirs_l1_files_path, sza_rad_data, oli_tirs_l1_area):
    """Create the file for the Landsat OLI TIRS L1 sza."""
    filename = oli_tirs_l1_files_path / "LC08_L1TP_026200_20240502_20240513_02_T2_SZA.TIF"
    create_tif_file(sza_rad_data, "sza", oli_tirs_l1_area, filename, oli_tirs_l1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l1_mda_file(oli_tirs_l1_files_path):
    """Create the Landsat OLI TIRS L1 metadata xml file."""
    filename = oli_tirs_l1_files_path / "LC08_L1TP_026200_20240502_20240513_02_T2_MTL.xml"
    with open(filename, "wb") as f:
        f.write(oli_tirs_l1_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l1_all_files(oli_tirs_l1_b4_file, oli_tirs_l1_b11_file, oli_tirs_l1_mda_file, oli_tirs_l1_sza_file):
    """Return all the files."""
    return oli_tirs_l1_b4_file, oli_tirs_l1_b11_file, oli_tirs_l1_mda_file, oli_tirs_l1_sza_file


@pytest.fixture(scope="session")
def oli_tirs_l2_b4_file(oli_tirs_l2_files_path, spectral_data, oli_tirs_l2_area):
    """Create the file for the Landsat OLI TIRS L2 B4 channel."""
    filename = oli_tirs_l2_files_path / "LC09_L2SP_029030_20240616_20240617_02_T1_SR_B4.TIF"
    create_tif_file(spectral_data, "B4", oli_tirs_l2_area, filename, oli_tirs_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def oli_tirs_l2_b10_file(oli_tirs_l2_files_path, thermal_data, oli_tirs_l2_area):
    """Create the file for the Landsat OLI TIRS L2 B10 channel."""
    filename = oli_tirs_l2_files_path / "LC09_L2SP_029030_20240616_20240617_02_T1_ST_B10.TIF"
    create_tif_file(thermal_data, "B10", oli_tirs_l2_area, filename, oli_tirs_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def oli_tirs_l2_rad_file(oli_tirs_l2_files_path, sza_rad_data, oli_tirs_l2_area):
    """Create the file for the Landsat OLI TIRS L2 TRAD channel."""
    filename = oli_tirs_l2_files_path / "LC09_L2SP_029030_20240616_20240617_02_T1_ST_TRAD.TIF"
    create_tif_file(sza_rad_data, "TRAD", oli_tirs_l2_area, filename, oli_tirs_l2_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l2_mda_file(oli_tirs_l2_files_path):
    """Create the Landsat OLI TIRS L2 metadata xml file."""
    filename = oli_tirs_l2_files_path / "LC09_L2SP_029030_20240616_20240617_02_T1_MTL.xml"
    with open(filename, "wb") as f:
        f.write(oli_tirs_l2_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def oli_tirs_l2_all_files(oli_tirs_l2_b4_file, oli_tirs_l2_b10_file, oli_tirs_l2_mda_file, oli_tirs_l2_rad_file):
    """Return all the files."""
    return oli_tirs_l2_b4_file, oli_tirs_l2_b10_file, oli_tirs_l2_mda_file, oli_tirs_l2_rad_file


@pytest.fixture(scope="session")
def etm_l1_b4_file(etm_l1_files_path, spectral_data, etm_l1_area):
    """Create the file for the Landsat ETM+ L1 B4 channel."""
    filename = etm_l1_files_path / "LE07_L1TP_230080_20231208_20240103_02_T1_B4.TIF"
    create_tif_file(spectral_data, "B4", etm_l1_area, filename, etm_l1_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def etm_l1_b6_file(etm_l1_files_path, thermal_data, etm_l1_area):
    """Create the file for the Landsat ETM+ L1 B6 channel."""
    filename = etm_l1_files_path / "LE07_L1TP_230080_20231208_20240103_02_T1_B6_VCID_1.TIF"
    create_tif_file(thermal_data, "B6_VCID_1", etm_l1_area, filename, etm_l1_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def etm_l1_sza_file(etm_l1_files_path, sza_rad_data, etm_l1_area):
    """Create the file for the Landsat ETM+ L1 sza."""
    filename = etm_l1_files_path / "LE07_L1TP_230080_20231208_20240103_02_T1_SZA.TIF"
    create_tif_file(sza_rad_data, "sza", etm_l1_area, filename, etm_l1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def etm_l1_mda_file(etm_l1_files_path):
    """Create the Landsat ETM+ L1 metadata xml file."""
    filename = etm_l1_files_path / "LE07_L1TP_230080_20231208_20240103_02_T1_MTL.xml"
    with open(filename, "wb") as f:
        f.write(etm_l1_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def etm_l1_all_files(etm_l1_b4_file, etm_l1_b6_file, etm_l1_mda_file, etm_l1_sza_file):
    """Return all the files."""
    return etm_l1_b4_file, etm_l1_b6_file, etm_l1_mda_file, etm_l1_sza_file


@pytest.fixture(scope="session")
def etm_l2_b4_file(etm_l2_files_path, spectral_data, etm_l2_area):
    """Create the file for the Landsat ETM+ L2 B4 channel."""
    filename = etm_l2_files_path / "LE07_L2SP_028030_20230817_20230912_02_T1_SR_B4.TIF"
    create_tif_file(spectral_data, "B4", etm_l2_area, filename, etm_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def etm_l2_b6_file(etm_l2_files_path, thermal_data, etm_l2_area):
    """Create the file for the Landsat ETM+ L2 B6 channel."""
    filename = etm_l2_files_path / "LE07_L2SP_028030_20230817_20230912_02_T1_ST_B6.TIF"
    create_tif_file(thermal_data, "B6", etm_l2_area, filename, etm_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def etm_l2_rad_file(etm_l2_files_path, sza_rad_data, etm_l2_area):
    """Create the file for the Landsat ETM+ L2 TRAD channel."""
    filename = etm_l2_files_path / "LE07_L2SP_028030_20230817_20230912_02_T1_ST_TRAD.TIF"
    create_tif_file(sza_rad_data, "TRAD", etm_l2_area, filename, etm_l2_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def etm_l2_mda_file(etm_l2_files_path):
    """Create the Landsat ETM+ L2 metadata xml file."""
    filename = etm_l2_files_path / "LE07_L2SP_028030_20230817_20230912_02_T1_MTL.xml"
    with open(filename, "wb") as f:
        f.write(etm_l2_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def etm_l2_all_files(etm_l2_b4_file, etm_l2_b6_file, etm_l2_mda_file, etm_l2_rad_file):
    """Return all the files."""
    return etm_l2_b4_file, etm_l2_b6_file, etm_l2_mda_file, etm_l2_rad_file


@pytest.fixture(scope="session")
def tm_l1_b4_file(tm_l1_files_path, spectral_data, tm_l1_area):
    """Create the file for the Landsat TM L1 B4 channel."""
    filename = tm_l1_files_path / "LT04_L1TP_143021_19890818_20200916_02_T1_B4.TIF"
    create_tif_file(spectral_data, "B4", tm_l1_area, filename, tm_l1_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def tm_l1_b6_file(tm_l1_files_path, thermal_data, tm_l1_area):
    """Create the file for the Landsat TM L1 B6 channel."""
    filename = tm_l1_files_path / "LT04_L1TP_143021_19890818_20200916_02_T1_B6.TIF"
    create_tif_file(thermal_data, "B6", tm_l1_area, filename, tm_l1_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def tm_l1_sza_file(tm_l1_files_path, sza_rad_data, tm_l1_area):
    """Create the file for the Landsat TM L1 sza."""
    filename = tm_l1_files_path / "LT04_L1TP_143021_19890818_20200916_02_T1_SZA.TIF"
    create_tif_file(sza_rad_data, "sza", tm_l1_area, filename, tm_l1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def tm_l1_mda_file(tm_l1_files_path):
    """Create the Landsat TM L1 metadata xml file."""
    filename = tm_l1_files_path / "LT04_L1TP_143021_19890818_20200916_02_T1_MTL.xml"
    with open(filename, "wb") as f:
        f.write(tm_l1_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def tm_l1_all_files(tm_l1_b4_file, tm_l1_b6_file, tm_l1_mda_file, tm_l1_sza_file):
    """Return all the files."""
    return tm_l1_b4_file, tm_l1_b6_file, tm_l1_mda_file, tm_l1_sza_file


@pytest.fixture(scope="session")
def tm_l2_b4_file(tm_l2_files_path, spectral_data, tm_l2_area):
    """Create the file for the Landsat TM L2 B4 channel."""
    filename = tm_l2_files_path / "LT05_L2SP_165054_20110817_20200820_02_T1_SR_B4.TIF"
    create_tif_file(spectral_data, "B4", tm_l2_area, filename, tm_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def tm_l2_b6_file(tm_l2_files_path, thermal_data, tm_l2_area):
    """Create the file for the Landsat TM L2 B6 channel."""
    filename = tm_l2_files_path / "LT05_L2SP_165054_20110817_20200820_02_T1_ST_B6.TIF"
    create_tif_file(thermal_data, "B6", tm_l2_area, filename, tm_l2_date)
    return os.fspath(filename)

@pytest.fixture(scope="session")
def tm_l2_rad_file(tm_l2_files_path, sza_rad_data, tm_l2_area):
    """Create the file for the Landsat TM L2 TRAD channel."""
    filename = tm_l2_files_path / "LT05_L2SP_165054_20110817_20200820_02_T1_ST_TRAD.TIF"
    create_tif_file(sza_rad_data, "TRAD", tm_l2_area, filename, tm_l2_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def tm_l2_mda_file(tm_l2_files_path):
    """Create the Landsat TM L2 metadata xml file."""
    filename = tm_l2_files_path / "LT05_L2SP_165054_20110817_20200820_02_T1_MTL.xml"
    with open(filename, "wb") as f:
        f.write(tm_l2_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def tm_l2_all_files(tm_l2_b4_file, tm_l2_b6_file, tm_l2_mda_file, tm_l2_rad_file):
    """Return all the files."""
    return tm_l2_b4_file, tm_l2_b6_file, tm_l2_mda_file, tm_l2_rad_file


@pytest.fixture(scope="session")
def mss_l1_landsat1_b4_file(mss_l1_landsat1_files_path, spectral_data, mss_l1_landsat1_area):
    """Create the file for the Landsat-1 MSS L1 B4 channel."""
    filename = mss_l1_landsat1_files_path / "LM01_L1TP_032030_19720729_20200909_02_T2_B4.TIF"
    create_tif_file(spectral_data, "B4", mss_l1_landsat1_area, filename, mss_l1_landsat1_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def mss_l1_landsat1_mda_file(mss_l1_landsat1_files_path):
    """Create the Landsat-1 MSS L1 metadata xml file."""
    filename = mss_l1_landsat1_files_path / "LM01_L1TP_032030_19720729_20200909_02_T2_MTL.xml"
    with open(filename, "wb") as f:
        f.write(mss_l1_landsat1_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def mss_l1_landsat1_all_files(mss_l1_landsat1_b4_file, mss_l1_landsat1_mda_file):
    """Return all the files."""
    return mss_l1_landsat1_b4_file, mss_l1_landsat1_mda_file


@pytest.fixture(scope="session")
def mss_l1_landsat4_b4_file(mss_l1_landsat4_files_path, spectral_data, mss_l1_landsat4_area):
    """Create the file for the Landsat-4 MSS L1 B4 channel."""
    filename = mss_l1_landsat4_files_path / "LM04_L1TP_029030_19840415_20200903_02_T2_B4.TIF"
    create_tif_file(spectral_data, "B4", mss_l1_landsat4_area, filename, mss_l1_landsat4_date)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def mss_l1_landsat4_mda_file(mss_l1_landsat4_files_path):
    """Create the Landsat-4 MSS L1 metadata xml file."""
    filename = mss_l1_landsat4_files_path / "LM04_L1TP_029030_19840415_20200903_02_T2_MTL.xml"
    with open(filename, "wb") as f:
        f.write(mss_l1_landsat4_metadata_text)
    return os.fspath(filename)


@pytest.fixture(scope="session")
def mss_l1_landsat4_all_files(mss_l1_landsat4_b4_file, mss_l1_landsat4_mda_file):
    """Return all the files."""
    return mss_l1_landsat4_b4_file, mss_l1_landsat4_mda_file


@pytest.fixture(scope="session")
def antarctic_mda_file(antarctic_files_path):
    """Create the Antarctic Landsat OLI-TIRS L1 metadata xml file."""
    filename = antarctic_files_path / "LC08_L1GT_132122_20220301_20220308_02_T2_MTL.xml"
    with open(filename, "wb") as f:
        f.write(antarctic_metadata_text)
    return os.fspath(filename)


class TestLandsat:
    """Test Landsat image readers."""

    @pytest.fixture(autouse=True)
    def setup_method(self, date, level_correction, spacecraft, data_type):
        """Set up the filename and filetype info dicts."""
        self.filename_info = dict(observation_date=date,
                                  platform_type="L",
                                  process_level_correction=level_correction,
                                  spacecraft_id=spacecraft,
                                  data_type=data_type,
                                  collection_id="02")
        self.ftype_info = {"file_type": "granule_B4"}

    @pytest.mark.parametrize(
        (
            "reader", "spectral_name", "thermal_name", "all_files", "area",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", "B4", "B11", "oli_tirs_l1_all_files", "oli_tirs_l1_area",
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_tif", "B4", "B10", "oli_tirs_l2_all_files", "oli_tirs_l2_area",
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_tif", "B4", "B6_VCID_1", "etm_l1_all_files", "etm_l1_area",
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_tif", "B4", "B6", "etm_l2_all_files", "etm_l2_area",
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_tif", "B4", "B6", "tm_l1_all_files", "tm_l1_area",
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_tif", "B4", "B6", "tm_l2_all_files", "tm_l2_area",
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat1_all_files", "mss_l1_landsat1_area",
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat4_all_files", "mss_l1_landsat4_area",
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    @pytest.mark.parametrize("remote", [True, False])
    def test_basicload(self, reader, area, all_files, spectral_name, thermal_name, remote, request):
        """Test loading a Landsat Scene."""
        all_files = request.getfixturevalue(all_files)
        area = request.getfixturevalue(area)

        if remote:
            all_files = convert_to_fsfile(all_files)

        scn = Scene(reader=reader, filenames=all_files)
        if thermal_name is not None:
            scn.load([spectral_name, thermal_name])
        else:
            scn.load([spectral_name])

        # Check dataset is loaded correctly
        assert scn[spectral_name].shape == (100, 100)
        assert scn[spectral_name].attrs["area"] == area
        assert scn[spectral_name].attrs["saturated"]
        if thermal_name is not None:
            assert scn[thermal_name].shape == (100, 100)
            assert scn[thermal_name].attrs["area"] == area
            if reader in ["oli_tirs_l1_tif", "oli_tirs_l2_tif", "etm_l2_tif"]:
                # OLI TIRS and ETM+ L2 do not have saturation flag on thermal band
                with pytest.raises(KeyError, match="saturated"):
                    assert not scn[thermal_name].attrs["saturated"]
            else:
                assert not scn[thermal_name].attrs["saturated"]
        # Check if MSS sets wavelength correctly
        if reader == "mss_l1_tif":
            if self.filename_info["spacecraft_id"] == "04":
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].min == 0.8
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].central == 0.95
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].max == 1.1
            elif self.filename_info["spacecraft_id"] == "01":
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].min == 0.5
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].central == 0.55
                assert scn["B4"].attrs["_satpy_id"]["wavelength"].max == 0.6

    @pytest.mark.parametrize(
        (
            "reader", "date_time", "spectral_file", "spectral_name", "mda_file",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", oli_tirs_l1_datetime, "oli_tirs_l1_b4_file", "B4", "oli_tirs_l1_mda_file",
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_tif", oli_tirs_l2_datetime, "oli_tirs_l2_b4_file", "B4", "oli_tirs_l2_mda_file",
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_tif", etm_l1_datetime, "etm_l1_b4_file", "B4", "etm_l1_mda_file",
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_tif", etm_l2_datetime, "etm_l2_b4_file", "B4", "etm_l2_mda_file",
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_tif", tm_l1_datetime, "tm_l1_b4_file", "B4", "tm_l1_mda_file",
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_tif", tm_l2_datetime, "tm_l2_b4_file", "B4", "tm_l2_mda_file",
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_tif", mss_l1_landsat1_datetime, "mss_l1_landsat1_b4_file", "B4", "mss_l1_landsat1_mda_file",
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", mss_l1_landsat4_datetime, "mss_l1_landsat4_b4_file", "B4", "mss_l1_landsat4_mda_file",
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_ch_startend(self, reader, spectral_file, mda_file, spectral_name, date_time, request):
        """Test correct retrieval of start/end times."""
        spectral_file = request.getfixturevalue(spectral_file)
        mda_file = request.getfixturevalue(mda_file)

        scn = Scene(reader=reader, filenames=[spectral_file, mda_file])
        bnds = scn.available_dataset_names()
        assert bnds == [spectral_name]

        scn.load(["B4"])
        assert scn.start_time == date_time
        assert scn.end_time == date_time

    @pytest.mark.parametrize(
        (
            "spectral_file", "mda_file", "CH_reader_class", "MD_reader_class",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_b4_file", "oli_tirs_l1_mda_file", OLITIRSCHReader, LandsatL1MDReader,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_b4_file", "oli_tirs_l2_mda_file", OLITIRSL2CHReader, LandsatL2MDReader,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_b4_file", "etm_l1_mda_file", ETMCHReader, LandsatL1MDReader,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_b4_file", "etm_l2_mda_file", ETML2CHReader, LandsatL2MDReader,
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_b4_file", "tm_l1_mda_file", TMCHReader, LandsatL1MDReader,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_b4_file", "tm_l2_mda_file", TML2CHReader, LandsatL2MDReader,
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_landsat1_b4_file", "mss_l1_landsat1_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_landsat4_b4_file", "mss_l1_landsat4_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_loading_gd(self, CH_reader_class, MD_reader_class, mda_file, spectral_file, request):
        """Test loading a Landsat Scene with good channel requests."""
        spectral_file = request.getfixturevalue(spectral_file)
        mda_file = request.getfixturevalue(mda_file)

        good_mda = MD_reader_class(mda_file, self.filename_info, {})
        rdr = CH_reader_class(spectral_file, self.filename_info, self.ftype_info, good_mda)

        # Check case with good file data and load request
        rdr.get_dataset({"name": "B4", "calibration": "counts"}, {"standard_name": "test_data", "units": "test_units"})

    @pytest.mark.parametrize(
        (
            "spectral_file", "mda_file", "CH_reader_class", "MD_reader_class",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_b4_file", "oli_tirs_l1_mda_file", OLITIRSCHReader, LandsatL1MDReader,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_b4_file", "oli_tirs_l2_mda_file", OLITIRSL2CHReader, LandsatL2MDReader,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_b4_file", "etm_l1_mda_file", ETMCHReader, LandsatL1MDReader,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_b4_file", "etm_l2_mda_file", ETML2CHReader, LandsatL2MDReader,
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_b4_file", "tm_l1_mda_file", TMCHReader, LandsatL1MDReader,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_b4_file", "tm_l2_mda_file", TML2CHReader, LandsatL2MDReader,
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_landsat1_b4_file", "mss_l1_landsat1_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_landsat4_b4_file", "mss_l1_landsat4_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_loading_badfil(self, CH_reader_class, MD_reader_class, mda_file, spectral_file, request):
        """Test loading a Landsat Scene with bad channel requests."""
        spectral_file = request.getfixturevalue(spectral_file)
        mda_file = request.getfixturevalue(mda_file)

        good_mda = MD_reader_class(mda_file, self.filename_info, {})
        rdr = CH_reader_class(spectral_file, self.filename_info, self.ftype_info, good_mda)

        ftype = {"standard_name": "test_data", "units": "test_units"}
        # Check case with request to load channel not matching filename
        with pytest.raises(ValueError, match="Requested channel B5 does not match the reader channel B4"):
            rdr.get_dataset({"name": "B5", "calibration": "counts"}, ftype)

    @pytest.mark.parametrize(
        (
            "thermal_file", "mda_file", "CH_reader_class", "MD_reader_class",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_b11_file", "oli_tirs_l1_mda_file", OLITIRSCHReader, LandsatL1MDReader,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_b10_file", "oli_tirs_l2_mda_file", OLITIRSL2CHReader, LandsatL2MDReader,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
        ],
    )
    def test_loading_badchan(self, CH_reader_class, MD_reader_class, mda_file, thermal_file, request):
        """Test loading a Landsat Scene with bad channel requests."""
        thermal_file = request.getfixturevalue(thermal_file)
        mda_file = request.getfixturevalue(mda_file)

        good_mda = MD_reader_class(mda_file, self.filename_info, {})
        ftype = {"standard_name": "test_data", "units": "test_units"}
        bad_finfo = self.filename_info.copy()
        bad_finfo["data_type"] = "T"

        # Check loading invalid channel for data type
        rdr = CH_reader_class(thermal_file, bad_finfo, self.ftype_info, good_mda)
        with pytest.raises(ValueError, match="Requested channel B4 is not available in this granule"):
            rdr.get_dataset({"name": "B4", "calibration": "counts"}, ftype)

        if self.filename_info["process_level_correction"] == "L1TP":
            # L1 test
            bad_finfo["data_type"] = "O"
            ftype_b11 = self.ftype_info.copy()
            ftype_b11["file_type"] = "granule_B11"
            rdr = CH_reader_class(thermal_file, bad_finfo, ftype_b11, good_mda)
            with pytest.raises(ValueError, match="Requested channel B11 is not available in this granule"):
                rdr.get_dataset({"name": "B11", "calibration": "counts"}, ftype)
        else:
            # L2 test
            bad_finfo["data_type"] = "O"
            ftype_b10 = self.ftype_info.copy()
            ftype_b10["file_type"] = "granule_B10"
            rdr = OLITIRSL2CHReader(thermal_file, bad_finfo, ftype_b10, good_mda)
            with pytest.raises(ValueError, match="Requested channel B10 is not available in this granule"):
                rdr.get_dataset({"name": "B10", "calibration": "counts"}, ftype)

    @pytest.mark.parametrize(
        (
            "spectral_file", "mda_file", "CH_reader_class", "MD_reader_class",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_b4_file", "oli_tirs_l1_mda_file", OLITIRSCHReader, LandsatL1MDReader,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_b4_file", "oli_tirs_l2_mda_file", OLITIRSL2CHReader, LandsatL2MDReader,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_b4_file", "etm_l1_mda_file", ETMCHReader, LandsatL1MDReader,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_b4_file", "etm_l2_mda_file", ETML2CHReader, LandsatL2MDReader,
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_b4_file", "tm_l1_mda_file", TMCHReader, LandsatL1MDReader,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_b4_file", "tm_l2_mda_file", TML2CHReader, LandsatL2MDReader,
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_landsat1_b4_file", "mss_l1_landsat1_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_landsat4_b4_file", "mss_l1_landsat4_mda_file", MSSCHReader, LandsatL1MDReader,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_badfiles(self, CH_reader_class, MD_reader_class, mda_file, spectral_file, request):
        """Test loading a Landsat Scene with bad data."""
        spectral_file = request.getfixturevalue(spectral_file)
        mda_file = request.getfixturevalue(mda_file)

        bad_fname_info = self.filename_info.copy()
        bad_fname_info["platform_type"] = "B"

        bad_ftype_info = self.ftype_info.copy()
        bad_ftype_info["file_type"] = "granule-b05"

        ftype = {"standard_name": "test_data", "units": "test_units"}

        # Test that metadata reader initialises with correct filename
        good_mda = MD_reader_class(mda_file, self.filename_info, ftype)

        # Check metadata reader fails if platform type is wrong
        with pytest.raises(ValueError, match="This reader only supports Landsat data"):
            MD_reader_class(mda_file, bad_fname_info, ftype)

        # Test that metadata reader initialises with correct filename
        CH_reader_class(spectral_file, self.filename_info, self.ftype_info, good_mda)

        # Check metadata reader fails if platform type is wrong
        with pytest.raises(ValueError, match="This reader only supports Landsat data"):
            CH_reader_class(spectral_file, bad_fname_info, self.ftype_info, good_mda)

        with pytest.raises(ValueError, match="Invalid file type: granule-b05"):
            CH_reader_class(spectral_file, self.filename_info, bad_ftype_info, good_mda)

    @pytest.mark.parametrize(
        (
            "reader", "spectral_name", "thermal_name", "all_files",
            "date", "level_correction", "spacecraft", "data_type"
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", "B4", "B11", "oli_tirs_l1_all_files",
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_tif", "B4", "B10", "oli_tirs_l2_all_files",
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_tif", "B4", "B6_VCID_1", "etm_l1_all_files",
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_tif", "B4", "B6", "etm_l2_all_files",
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_tif", "B4", "B6", "tm_l1_all_files",
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_tif", "B4", "B6", "tm_l2_all_files",
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat1_all_files",
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat4_all_files",
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_calibration_counts(
        self,
        reader,
        all_files,
        spectral_name,
        thermal_name,
        spectral_data,
        thermal_data,
        request
    ):
        """Test counts calibration mode for the reader."""
        all_files = request.getfixturevalue(all_files)

        scn = Scene(reader=reader, filenames=all_files)
        if thermal_name is not None:
            scn.load([spectral_name, thermal_name], calibration="counts")
        else:
            scn.load([spectral_name], calibration="counts")

        np.testing.assert_allclose(scn[spectral_name].values, spectral_data)
        assert scn[spectral_name].attrs["units"] == "1"
        assert scn[spectral_name].attrs["standard_name"] == "counts"

        if thermal_name is not None:
            np.testing.assert_allclose(scn[thermal_name].values, thermal_data)
            assert scn[thermal_name].attrs["units"] == "1"
            assert scn[thermal_name].attrs["standard_name"] == "counts"

    @pytest.mark.parametrize(
        (
            "reader", "spectral_name", "thermal_name", "all_files", "cal_spectral_params", "cal_thermal_params",
            "date", "level_correction", "spacecraft", "data_type"
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", "B4", "B11", "oli_tirs_l1_all_files", oli_tirs_l1_sp_params, oli_tirs_l1_th_params,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "etm_l1_tif", "B4", "B6_VCID_1", "etm_l1_all_files", etm_l1_sp_params, etm_l1_th_params,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "tm_l1_tif", "B4", "B6", "tm_l1_all_files", tm_l1_sp_params, tm_l1_th_params,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat1_all_files", mss_l1_landsat1_sp_params, None,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, "mss_l1_landsat4_all_files", mss_l1_landsat4_sp_params, None,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_calibration_radiance(
        self,
        reader,
        all_files,
        spectral_name,
        thermal_name,
        cal_spectral_params,
        cal_thermal_params,
        spectral_data,
        thermal_data,
        request,
    ):
        """Test radiance calibration mode for the reader."""
        all_files = request.getfixturevalue(all_files)

        exp_spectral = (spectral_data * cal_spectral_params[0] + cal_spectral_params[1]).astype(np.float32)
        if thermal_name is not None:
            exp_thermal = (thermal_data * cal_thermal_params[0] + cal_thermal_params[1]).astype(np.float32)

        scn = Scene(reader=reader, filenames=all_files)
        if thermal_name is not None:
            scn.load([spectral_name, thermal_name], calibration="radiance")
        else:
            scn.load([spectral_name], calibration="radiance")

        assert scn[spectral_name].attrs["units"] == "W m-2 um-1 sr-1"
        assert scn[spectral_name].attrs["standard_name"] == "toa_outgoing_radiance_per_unit_wavelength"
        np.testing.assert_allclose(scn[spectral_name].values, exp_spectral, rtol=1e-4)

        if thermal_name is not None:
            assert scn[thermal_name].attrs["units"] == "W m-2 um-1 sr-1"
            assert scn[thermal_name].attrs["standard_name"] == "toa_outgoing_radiance_per_unit_wavelength"
            np.testing.assert_allclose(scn[thermal_name].values, exp_thermal, rtol=1e-4)

    @pytest.mark.parametrize(
        (
            "reader", "spectral_name", "thermal_name", "sza_rad_name", "all_files",
            "cal_spectral_params", "cal_thermal_params",
            "date", "level_correction", "spacecraft", "data_type",
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", "B4", "B11", None, "oli_tirs_l1_all_files",
                oli_tirs_l1_sp_params, oli_tirs_l1_th_params,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_tif", "B4", "B10", "TRAD", "oli_tirs_l2_all_files",
                oli_tirs_l2_sp_params, oli_tirs_l2_th_params,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_tif", "B4", "B6_VCID_1", None, "etm_l1_all_files",
                etm_l1_sp_params, etm_l1_th_params,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "etm_l2_tif", "B4", "B6", "TRAD", "etm_l2_all_files",
                etm_l2_sp_params, etm_l2_th_params,
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                "tm_l1_tif", "B4", "B6", None, "tm_l1_all_files",
                tm_l1_sp_params, tm_l1_th_params,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                "tm_l2_tif", "B4", "B6", "TRAD", "tm_l2_all_files",
                tm_l2_sp_params, tm_l2_th_params,
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, None, "mss_l1_landsat1_all_files",
                mss_l1_landsat1_sp_params, None,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", "B4", None, None, "mss_l1_landsat4_all_files",
                mss_l1_landsat4_sp_params, None,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
        ],
    )
    def test_calibration_highlevel(
        self,
        reader,
        all_files,
        spectral_name,
        thermal_name,
        sza_rad_name,
        cal_spectral_params,
        cal_thermal_params,
        spectral_data,
        thermal_data,
        sza_rad_data,
        request,
    ):
        """Test high level calibration modes for the reader."""
        all_files = request.getfixturevalue(all_files)

        if self.filename_info["process_level_correction"] == "L2SP":
            exp_spectral = (spectral_data * cal_spectral_params[0] + cal_spectral_params[1]).astype(np.float32) * 100
            if thermal_name is not None:
                exp_thermal = (thermal_data * cal_thermal_params[0] + cal_thermal_params[1]).astype(np.float32)
                exp_rad = (sza_rad_data * 0.001).astype(np.float32)
        else:
            exp_spectral = (spectral_data * cal_spectral_params[2] + cal_spectral_params[3]).astype(np.float32) * 100
            if thermal_name is not None:
                exp_thermal = (thermal_data * cal_thermal_params[0] + cal_thermal_params[1])
                exp_thermal = (cal_thermal_params[3] / np.log((cal_thermal_params[2] / exp_thermal) + 1))
                exp_thermal = exp_thermal.astype(np.float32)

        scn = Scene(reader=reader, filenames=all_files)
        if thermal_name is not None:
            if self.filename_info["process_level_correction"] == "L2SP":
                scn.load([spectral_name, thermal_name, sza_rad_name])
            else:
                scn.load([spectral_name, thermal_name])
        else:
            scn.load([spectral_name])

        assert scn[spectral_name].attrs["units"] == "%"
        if self.filename_info["process_level_correction"] == "L2SP":
            assert scn[spectral_name].attrs["standard_name"] == "surface_bidirectional_reflectance"
        else:
            assert scn[spectral_name].attrs["standard_name"] == "toa_bidirectional_reflectance"
        np.testing.assert_allclose(np.array(scn[spectral_name].values), np.array(exp_spectral), rtol=1e-4)
        if thermal_name is not None:
            assert scn[thermal_name].attrs["units"] == "K"
            assert scn[thermal_name].attrs["standard_name"] == "brightness_temperature"
            np.testing.assert_allclose(scn[thermal_name].values, exp_thermal, rtol=1e-6)
            if self.filename_info["process_level_correction"] == "L2SP":
                assert scn[sza_rad_name].attrs["units"] == "W m-2 um-1 sr-1"
                assert scn[sza_rad_name].attrs["standard_name"] == "toa_outgoing_radiance_per_unit_wavelength"
                np.testing.assert_allclose(scn[sza_rad_name].values, exp_rad, rtol=1e-6)

    @pytest.mark.parametrize(
        ("reader", "all_files", "date", "level_correction", "spacecraft", "data_type"),
        [
            pytest.param(
                "oli_tirs_l1_tif", "oli_tirs_l1_all_files", oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                "etm_l1_tif", "etm_l1_all_files", etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                "tm_l1_tif", "tm_l1_all_files", tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
        ],
    )
    def test_angles(self, reader, all_files, sza_rad_data, request):
        """Test calibration modes for the reader."""
        # Check angles are calculated correctly
        all_files = request.getfixturevalue(all_files)

        scn = Scene(reader=reader, filenames=all_files)
        scn.load(["solar_zenith_angle"])
        assert scn["solar_zenith_angle"].attrs["units"] == "degrees"
        assert scn["solar_zenith_angle"].attrs["standard_name"] == "solar_zenith_angle"
        np.testing.assert_allclose(scn["solar_zenith_angle"].values * 100,
                                   np.array(sza_rad_data),
                                   atol=0.01,
                                   rtol=1e-3)

    @pytest.mark.parametrize(
        (
            "reader", "MD_reader_class", "mda_file", "cal_dict",
            "date", "level_correction", "spacecraft", "data_type", "platform_name", "earth_sun_distance",
        ),
        [
            pytest.param(
                "oli_tirs_l1_tif", LandsatL1MDReader, "oli_tirs_l1_mda_file", oli_tirs_l1_cal_dict,
                oli_tirs_l1_date, "L1TP", "08", "C", "Landsat-8", 1.0079981, id="oli_tirs_l1",
            ),
            pytest.param(
                "oli_tirs_l2_tif", LandsatL2MDReader, "oli_tirs_l2_mda_file", oli_tirs_l2_cal_dict,
                oli_tirs_l2_date, "L2SP", "09", "C", "Landsat-9", 1.0158933, id="oli_tirs_l2",
            ),
            pytest.param(
                "etm_l1_tif", LandsatL1MDReader, "etm_l1_mda_file", etm_l1_cal_dict,
                etm_l1_date, "L1TP", "07", "E", "Landsat-7", 0.9850987, id="etm_l1",
            ),
            pytest.param(
                "etm_l2_tif", LandsatL2MDReader, "etm_l2_mda_file", etm_l2_cal_dict,
                etm_l2_date, "L2SP", "07", "E", "Landsat-7", 1.0124651, id="etm_l2",
            ),
            pytest.param(
                "tm_l1_tif", LandsatL1MDReader, "tm_l1_mda_file", tm_l1_cal_dict,
                tm_l1_date, "L1TP", "04", "T", "Landsat-4", 1.0122057, id="tm_l1",
            ),
            pytest.param(
                "tm_l2_tif", LandsatL2MDReader, "tm_l2_mda_file", tm_l2_cal_dict,
                tm_l2_date, "L2SP", "05", "T", "Landsat-5", 1.0125021, id="tm_l2",
            ),
            pytest.param(
                "mss_l1_tif", LandsatL1MDReader, "mss_l1_landsat1_mda_file", mss_l1_landsat1_cal_dict,
                mss_l1_landsat1_date, "L1TP", "01", "M", "Landsat-1", 1.0152109, id="mss_l1_landsat1",
            ),
            pytest.param(
                "mss_l1_tif", LandsatL1MDReader, "mss_l1_landsat4_mda_file", mss_l1_landsat4_cal_dict,
                mss_l1_landsat4_date, "L1TP", "04", "M", "Landsat-4", 1.0035512, id="mss_l1_landsat4",
            ),
        ],
    )
    def test_metadata(self, reader, MD_reader_class, mda_file, cal_dict, platform_name, earth_sun_distance, request):
        """Check that metadata values loaded correctly."""
        mda_file = request.getfixturevalue(mda_file)

        mda = MD_reader_class(mda_file, self.filename_info, {})

        assert mda.platform_name == platform_name
        assert mda.earth_sun_distance() == earth_sun_distance

        cal_bands = list(cal_dict.keys())
        assert mda.band_calibration[cal_bands[0]] == cal_dict[cal_bands[0]]
        assert mda.band_calibration[cal_bands[1]] == cal_dict[cal_bands[1]]
        assert mda.band_calibration[cal_bands[2]] == cal_dict[cal_bands[2]]
        assert not mda.band_saturation[cal_bands[0]]
        assert mda.band_saturation["B4"]
        assert not mda.band_saturation[cal_bands[1]]
        if reader in ["oli_tirs_l1_tif", "oli_tirs_l2_tif", "etm_l2_tif"]:
            with pytest.raises(KeyError):
                mda.band_saturation[cal_bands[2]]
        else:
            assert not mda.band_saturation[cal_bands[2]]

    @pytest.mark.parametrize(
        (
            "MD_reader_class", "mda_file", "extent", "pan_extent",
            "date", "level_correction", "spacecraft", "data_type"
        ),
        [
            pytest.param(
                LandsatL1MDReader, "oli_tirs_l1_mda_file", oli_tirs_l1_extent, oli_tirs_l1_pan_extent,
                oli_tirs_l1_date, "L1TP", "08", "C", id="oli_tirs_l1",
            ),
            pytest.param(
                LandsatL2MDReader, "oli_tirs_l2_mda_file", oli_tirs_l2_extent, None,
                oli_tirs_l2_date, "L2SP", "09", "C", id="oli_tirs_l2",
            ),
            pytest.param(
                LandsatL1MDReader, "etm_l1_mda_file", etm_l1_extent, etm_l1_pan_extent,
                etm_l1_date, "L1TP", "07", "E", id="etm_l1",
            ),
            pytest.param(
                LandsatL2MDReader, "etm_l2_mda_file", etm_l2_extent, None,
                etm_l2_date, "L2SP", "07", "E", id="etm_l2",
            ),
            pytest.param(
                LandsatL1MDReader, "tm_l1_mda_file", tm_l1_extent, None,
                tm_l1_date, "L1TP", "04", "T", id="tm_l1",
            ),
            pytest.param(
                LandsatL2MDReader, "tm_l2_mda_file", tm_l2_extent, None,
                tm_l2_date, "L2SP", "05", "T", id="tm_l2",
            ),
            pytest.param(
                LandsatL1MDReader, "mss_l1_landsat1_mda_file", mss_l1_landsat1_extent, None,
                mss_l1_landsat1_date, "L1TP", "01", "M", id="mss_l1_landsat1",
            ),
            pytest.param(
                LandsatL1MDReader, "mss_l1_landsat4_mda_file", mss_l1_landsat4_extent, None,
                mss_l1_landsat4_date, "L1TP", "04", "M", id="mss_l1_landsat4",
            ),
            pytest.param(
                LandsatL1MDReader, "antarctic_mda_file", antarctic_extent, antarctic_pan_extent,
                oli_tirs_l1_date, "L1TP", "08", "C", id="antarctic",
            ),
        ],
    )
    def test_area_def(self, MD_reader_class, mda_file, extent, pan_extent, request):
        """Check we can get the area defs properly."""
        mda_file = request.getfixturevalue(mda_file)

        mda = MD_reader_class(mda_file, self.filename_info, {})

        standard_area = mda.build_area_def("B4")
        assert standard_area.area_extent == extent

        if pan_extent is not None:
            pan_area = mda.build_area_def("B8")
            assert pan_area.area_extent == pan_extent
